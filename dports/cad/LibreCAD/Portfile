# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           github 1.0
PortGroup           qmake 1.0

github.setup        LibreCAD LibreCAD 2.0.2
categories          cad
platforms           darwin
maintainers         rvt.dds.nl:librecad \
                    gmail.com:dongxuli2011 \
                    openmaintainer

license             GPL-2+

description         LibreCAD is a free Open Source CAD application.

long_description    LibreCAD is a free Open Source CAD application for \
                    Windows, Apple and Linux. Support and documentation is \
                    free from our large, dedicated community of users, \
                    contributors and developers. You, too, can also get \
                    involved!

homepage            http://librecad.org/

checksums           rmd160  30ae8dc909fbc34f9b1f0f448b499813ab573c40 \
                    sha256  75460c0d959245d4257734bdbcac69887d6ebc91312499ed228d1c4b60d0b928

depends_lib-append  port:boost \
                    port:muparser \
                    port:freetype

if {${os.platform} eq "darwin" && ${os.major} < 13} {
    depends_lib
    pre-fetch {
        ui_error "${name} 2.x only works with OS X 10.9 Mavericks or later."
        ui_error "You might want to try a 1.x series release instead."
        error "incompatible OS X version"
    }
}

variant universal {}

build.args          CC="${configure.cc} [get_canonical_archflags cc]" \
                    CXX="${configure.cxx} [get_canonical_archflags cxx]" \
                    LINK="${configure.cxx} [get_canonical_archflags cxx]"

destroot {
    system -W ${worksrcpath} "macdeployqt LibreCAD.app"
    copy ${worksrcpath}/LibreCAD.app ${destroot}${applications_dir}
}
