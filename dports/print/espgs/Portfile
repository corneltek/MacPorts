# $Id: Portfile,v 1.8 2004/01/17 22:45:29 toby Exp $

PortSystem 1.0

name               espgs 
version            7.05.6
revision           2
categories         print textproc
description        Interpreter for PostScript and PDF 
maintainers        michaelm@opendarwin.org
homepage           http://www.cups.org/ghostscript.php
master_sites       sourceforge \
                     http://mirror.cs.wisc.edu/pub/mirrors/ghost/AFPL/fonts/:fonts
                   
distname           ${name}-${version}-source
set std_fonts      ghostscript-fonts-std-6.0
set other_fonts    ghostscript-fonts-other-6.0
distfiles	       ${distname}${extract.suffix} \
                     ${std_fonts}${extract.suffix}:fonts \
                     ${other_fonts}${extract.suffix}:fonts
                   
checksums         ${name}-${version}-source${extract.suffix} md5 23595e166693dcf9d504d7b8bd4ae48c \
                    ${std_fonts}${extract.suffix} md5 8250132d6fcc6eb1419f505f06c7690b \
                    ${other_fonts}${extract.suffix} md5 1a643ae62ef166562e4d422b1a601272

depends_lib        lib:libjpeg:jpeg lib:libpng:libpng lib:libz:zlib
platforms          darwin
worksrcdir         ${name}-${version}
      
configure.args     --with-gimp-print LDFLAGS='-L${prefix}/lib'  CFLAGS=-I'${prefix}/include' \
                   --disable-cups \
                   --with-fontpath="${prefix}/share/ghostscript/fonts:/usr/share/ghostscript/fonts"

build.target       ""
destroot.destdir   prefix=${destroot}${prefix} datadir=${destroot}${prefix}/share

post-destroot      { system "mkdir -p ${destroot}/${prefix}/share/ghostscript/"
                  system "cd ${workpath} && \
                        tar -cf - fonts | \
                        tar -xf - -C ${destroot}/${prefix}/share/ghostscript/"
                   }


variant     x11 {
                  depends_lib-append      lib:libX11:XFree86
                  configure.args-append   --with-x
                }
                
variant extra_fonts {
                  set other_fonts    ghostscript-fonts-other-6.0
                  distfiles-append   ${other_fonts}${extract.suffix}:fonts
                  checksums-append   ${other_fonts}${extract.suffix} md5 1a643ae62ef166562e4d422b1a601272
                  }
                 
                 
long_description Easy Software Products now produces maintenance updates of GNU Ghostscript under \
the name ESP Ghostscript. These updates incorporate bug fixes to the current GNU version of \
Ghostscript as well as the latest CUPS, GIMP-print, and other add-ons to Ghostscript.
