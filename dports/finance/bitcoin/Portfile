# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
name                bitcoin
categories          finance crypto
version             0.8.1
revision            0
platforms           darwin
license             MIT
maintainers         yopmail.com:sami.laine easieste openmaintainer
description         client user interface for a peer-to-peer digital currency
long_description    Bitcoin is a peer-to-peer digital currency. Peer-to-peer \
                    (P2P) means that there is no central authority to issue \
                    new money or keep track of transactions. Instead, these \
                    tasks are managed collectively by the nodes of then \
                    network. \
                    This port is for client user interface, if you're looking \
                    for daemon, use port `bitcoindÂ´ instead.
homepage            http://www.bitcoin.org/
master_sites        sourceforge
distname            ${name}-${version}-linux
checksums           md5     1f6698135cfab8695e0f826ffc428d4c \
                    sha1    94761c70572b8ede8721524bb0317ede2d3723ce \
                    rmd160  7054860b7ac2ce0a3be3392767a2395aa875ded5

depends_lib         port:boost \
                    port:openssl \
                    port:db48 \
                    port:miniupnpc \
                    port:qt4-mac

worksrcdir          ${name}-${version}-linux/src

configure.args      ""
configure.pre_args  ""
configure.post_args ""
configure.cmd       qmake
build.args          ""
build.pre_args      ""
build.post_args     ""
build.target        ""
build.cmd           (cd src && make -f makefile.osx ) && make

destroot {
    xinstall -d ${destroot}${prefix}/bin
    xinstall -d ${destroot}${prefix}/sbin
    if {![variant_isset daemon]} {
        xinstall -m 755 -W ${worksrcpath} \
            Bitcoin-Qt.app/Contents/MacOS/Bitcoin-Qt \
            ${destroot}${prefix}/bin/bitcoin-qt
    }
    xinstall -m 755 -W ${worksrcpath} src/bitcoind ${destroot}${prefix}/sbin

    set docdir ${destroot}${prefix}/share/doc/${name}
    xinstall -d ${docdir}
    eval xinstall -m 444 -W ${worksrcpath} [glob ${worksrcpath}/doc/*] ${docdir}
}

variant daemon description {Build and install only the bitcoind deamon} {
    set build.cmd "cd src && make -f makefile.osx"
    depends_lib-delete port:qt4-mac
}

