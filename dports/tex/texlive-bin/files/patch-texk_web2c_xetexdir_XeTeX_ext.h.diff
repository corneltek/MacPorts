--- texk/web2c/xetexdir/XeTeX_ext.h.orig	2011-08-08 00:14:45.000000000 -0400
+++ texk/web2c/xetexdir/XeTeX_ext.h	2011-08-08 00:17:19.000000000 -0400
@@ -313,6 +314,13 @@
 	void atsugetfontmetrics(ATSUStyle style, integer* ascent, integer* descent, integer* xheight, integer* capheight, integer* slant);
 
 #ifdef XETEX_MAC
+
+#include <ApplicationServices/ApplicationServices.h>
+/* These functions have been removed on 10.7; as a workaround, just do
+ * a cast as the ATSFontRef and ATSUFontID should have the same value... */
+#define FMGetFontFromATSFontRef(x) ((ATSUFontID) x)
+#define FMGetATSFontRefFromFont(x) ((ATSFontRef) x)
+
 /* functions in XeTeX_mac.c */
 	void* loadAATfont(ATSFontRef fontRef, integer scaled_size, const char* cp1);
 	void DoAtsuiLayout(void* node, int justify);
