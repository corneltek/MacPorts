--- tetex-src-3.0/texk/web2c/ptex/jbibtex.ch.orig	2010-02-18 22:49:18.000000000 +0900
+++ tetex-src-3.0/texk/web2c/ptex/jbibtex.ch	2010-02-18 22:50:29.000000000 +0900
@@ -1381,6 +1381,10 @@
     else decr(sp_end);
 end;
 
+{ Forgot to check for pool overflow here.  Triggered by test case linked
+  from http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=520920.}
+
+str_room(sp_end - sp_ptr);
 while (sp_ptr < sp_end) do                      {shift the substring}
     begin
     if str_pool[sp_ptr] >127 then begin
