PortSystem 1.0
name		bochs
version		1.4.1
revision	0
categories	emulators
maintainers	jpm@opendarwin.org
description	cross platform ia-32 emulator
platforms	darwin
master_sites	http://unc.dl.sourceforge.net/sourceforge/bochs/ \
		http://telia.dl.sourceforge.net/sourceforge/bochs/ \
		http://easynews.dl.sourceforge.net/sourceforge/bochs/ \
		http://umn.dl.sourceforge.net/sourceforge/bochs/ \
		http://twtelecom.dl.sourceforge.net/sourceforge/bochs/ \
		http://belnet.dl.sourceforge.net/sourceforge/bochs/ \
		http://switch.dl.sourceforge.net/sourceforge/bochs/ \
		http://cesnet.dl.sourceforge.net/sourceforge/bochs/
checksums	md5 12e591b5cec2e0051e18605483f64678
patchfiles 	patch-cdrom_osx
post-patch {
	set path "${portpath}/${workdir}/${worksrcdir}"
	set data_dir "${prefix}/bochs"
	
	reinplace "s|/usr/local/bochs|${data_dir}|g" "${path}/doc/man/bochs-dlx.1"
	reinplace "s|/usr/local/bochs|${data_dir}|g" "${path}/doc/man/bochs.1"
	reinplace "s|/usr/local/bochs|${data_dir}|g" "${path}/doc/man/bochsrc.1"
	reinplace "s|/usr/local/bochs|${data_dir}|g" "${path}/doc/man/bximage.1"
	
	reinplace "s|\@VERSION\@|${portversion}|g" "${path}/doc/man/bochs-dlx.1"
	reinplace "s|\@VERSION\@|${portversion}|g" "${path}/doc/man/bochs.1"
	reinplace "s|\@VERSION\@|${portversion}|g" "${path}/doc/man/bochsrc.1"
	reinplace "s|\@VERSION\@|${portversion}|g" "${path}/doc/man/bximage.1"

	reinplace "s|vgaromimage: bios/|vgaromimage: ${data_dir}/${portversion}/|g" "${path}/doc/man/bochsrc.1"
	reinplace "s|romimage: file=bios/|romimage: file=${data_dir}/${portversion}/|g" "${path}/doc/man/bochsrc.1"

	reinplace "s|vgaromimage: bios/|vgaromimage: ${data_dir}/${portversion}/|g" "${path}/.bochsrc"
	reinplace "s|romimage: file=bios/|romimage: file=${data_dir}/${portversion}/|g" "${path}/.bochsrc"
}
depends_run	bin:wget:wget
include		contents
