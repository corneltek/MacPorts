--- ../src/mac/menu.cpp	Sat Feb  7 13:38:18 2004
+++ ../src/mac/menu.cpp.new	Sat Feb  7 13:42:43 2004
@@ -67,6 +67,7 @@
 void wxMenu::Init()
 {
     m_doBreak = FALSE;
+    m_startRadioGroup = -1;
 
     // create the menu
 	Str255 	label;
@@ -152,6 +153,13 @@
 
 #endif // wxUSE_ACCEL
 
+void wxMenu::Attach(wxMenuBarBase *menubar)
+{
+    wxMenuBase::Attach(menubar);
+
+    EndRadioGroup();
+}
+
 // function appends a new item or submenu to the menu
 // append a new item or submenu to the menu
 bool wxMenu::DoInsertOrAppend(wxMenuItem *pItem, size_t pos)
@@ -269,9 +277,67 @@
 	return TRUE ;
 }
 
+void wxMenu::EndRadioGroup()
+{
+    // we're not inside a radio group any longer
+    m_startRadioGroup = -1;
+}
+
 bool wxMenu::DoAppend(wxMenuItem *item)
 {
-    return wxMenuBase::DoAppend(item) && DoInsertOrAppend(item);
+    wxCHECK_MSG( item, FALSE, _T("NULL item in wxMenu::DoAppend") );
+
+    bool check = FALSE;
+
+    if ( item->GetKind() == wxITEM_RADIO )
+    {
+        int count = GetMenuItemCount();
+
+        if ( m_startRadioGroup == -1 )
+        {
+            // start a new radio group
+            m_startRadioGroup = count;
+
+            // for now it has just one element
+            item->SetAsRadioGroupStart();
+            item->SetRadioGroupEnd(m_startRadioGroup);
+
+            // ensure that we have a checked item in the radio group
+            check = TRUE;
+        }
+        else // extend the current radio group
+        {
+            // we need to update its end item
+            item->SetRadioGroupStart(m_startRadioGroup);
+            wxMenuItemList::Node *node = GetMenuItems().Item(m_startRadioGroup);
+
+            if ( node )
+            {
+                node->GetData()->SetRadioGroupEnd(count);
+            }
+            else
+            {
+                wxFAIL_MSG( _T("where is the radio group start item?") );
+            }
+        }
+    }
+    else // not a radio item
+    {
+        EndRadioGroup();
+    }
+
+    if ( !wxMenuBase::DoAppend(item) || !DoInsertOrAppend(item) )
+    {
+        return FALSE;
+    }
+
+    if ( check )
+    {
+        // check the item initially
+        item->Check(TRUE);
+    }
+
+    return TRUE;
 }
 
 bool wxMenu::DoInsert(size_t pos, wxMenuItem *item)
@@ -431,11 +497,7 @@
 
 void wxMenu::MacEnableMenu( bool bDoEnable )
 {
-	if ( bDoEnable )
-		UMAEnableMenuItem(MAC_WXHMENU(m_hMenu) , 0 ) ;
-	else
-		UMADisableMenuItem(MAC_WXHMENU(m_hMenu) , 0 ) ;
-
+	UMAEnableMenuItem(MAC_WXHMENU(m_hMenu) , 0, bDoEnable ) ;
 	::DrawMenuBar() ;
 }
 
@@ -625,7 +687,7 @@
 						if ( item->GetId() == wxApp::s_macAboutMenuItemId )
 						{
 								::SetMenuItemText( GetMenuHandle( kwxMacAppleMenuId ) , 1 , label );
-								UMAEnableMenuItem( GetMenuHandle( kwxMacAppleMenuId ) , 1 );
+								UMAEnableMenuItem( GetMenuHandle( kwxMacAppleMenuId ) , 1, TRUE );
 								SetMenuItemCommandID( GetMenuHandle( kwxMacAppleMenuId ) , 1 , item->GetId() ) ;
  						}
 						else
