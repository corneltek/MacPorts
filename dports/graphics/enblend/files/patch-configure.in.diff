--- configure.in.orig	2012-07-31 16:33:15.000000000 +0200
+++ configure.in	2012-07-31 16:41:48.000000000 +0200
@@ -214,7 +214,7 @@
              [AC_MSG_NOTICE([forcing use of Boost "filesystem" library])
               AC_DEFINE(HAVE_BOOST_FILESYSTEM, 1,
                         [Define if you have boost/filesystem.hpp])
-              EXTRA_LIBS="-lboost_filesystem ${EXTRA_LIBS}"],
+              EXTRA_LIBS="-lboost_filesystem -lboost_system ${EXTRA_LIBS}"],
              [AC_CHECK_HEADER(boost/filesystem.hpp,
                               [],
                               AC_MSG_NOTICE([Boost "filesystem" header is missing.]))
@@ -231,20 +231,21 @@
                   fi
                   LIBS_ORIG=$LIBS
                   for x in $candidates; do
-                      LIBS="$LIBS_ORIG $x"
+                      y=`echo $x | sed s/boost_filesystem/boost_system/g`
+                      LIBS="$LIBS_ORIG $x $y"
                       AC_LINK_IFELSE([AC_LANG_PROGRAM([[
 #include <string>
 #include "boost/filesystem.hpp"
 ]],
 [[
-boost::filesystem::basic_path<std::string, boost::filesystem::path_traits> p("foo/bar/baz.oo");
+boost::filesystem::path p("foo/bar/baz.oo");
 p.branch_path().string();
 p.leaf();
 basename(p);
 extension(p);
 ]]
 )],
-                                     [EXTRA_LIBS="$x ${EXTRA_LIBS}"
+                                     [EXTRA_LIBS="$x $y ${EXTRA_LIBS}"
                                       found_boost_filesystem_lib=yes
                                       AC_MSG_NOTICE([compiling with Boost's generic filename parsing support.])
                                       break])
