# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name            openexr
version         2.2.0
categories      graphics
license         BSD
maintainers     blair
description     OpenEXR Graphics Library
long_description \
    OpenEXR is a high dynamic-range (HDR) image file format developed \
    by Industrial Light & Magic for use in computer imaging applications.
homepage        http://www.openexr.com
platforms       darwin
master_sites    http://savannah.nongnu.org/download/openexr
checksums       rmd160  a825ed42e731da3bc39f25ce2a310712a5b0f956 \
                sha256  36a012f6c43213f840ce29a8b182700f6cf6b214bea0d5735594136b44914231

if {${subport} ne "ilmbase"} {
    depends_build-append port:pkgconfig
}

if {${subport} eq ${name}} {
    depends_lib-append port:ilmbase

    # ImfCompressor.h is included in other header files
    # see #49965
    # see also https://lists.nongnu.org/archive/html/openexr-devel/2013-06/msg00001.html
    patchfiles \
        patch-IlmImf-Makefile.diff
}

subport ilmbase {
    distname    ilmbase-${version}
    checksums   \
        rmd160  b1adb0c96eff6b3554ddaf8f8bafe2cba8c114e3 \
        sha256  ecf815b60695555c1fbc73679e84c7c9902f4e8faa6e8000d2f905b8b86cedc7
}

test.run        yes
test.target     check

livecheck.type  regex
livecheck.url   ${homepage}/downloads.html
livecheck.regex ${name}-(\\d+(?:\\.\\d+)*)
