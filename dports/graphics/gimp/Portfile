# $Id: Portfile,v 1.19 2003/08/05 21:02:18 jkh Exp $

PortSystem 1.0
name		gimp
version		1.3.15
categories	graphics x11
maintainers	darwinports@opendarwin.org
description	GNU Image Manipulation Program
long_description The GNU Image Manipulation Program (GIMP) is a powerful \
		tool for the preparation and manipulation of digital images.\
		The GIMP provides the user with a wide variety of image \
		manipulation, painting, processing, and rendering tools.
platforms	darwin
use_bzip2	yes
master_sites	ftp://ftp.gtk.org/pub/gimp/v1.3/v${portversion}/
checksums	md5 c0ca246339857e3afdc47769c331f01a
depends_lib	lib:libgtk.2:gtk2 lib:libglib.2:glib2 \
		lib:libintl.1:gettext lib:libjpeg.62:jpeg \
		lib:libpng.3:libpng lib:libtiff.3:tiff \
		lib:libart_lgpl.2:libart_lgpl lib:libpango.1:libpango

patchfiles	patch-Makefile.in patch-plug_in_cmds.c \
		patch-procedural_db_cmds.c patch-regex.c patch-regex.h \
		patch-scriptfu-interp_regex.c

configure.env	PATH=$\{PATH\}:${prefix}/bin LDFLAGS=-L${prefix}/lib \
		CPPFLAGS=-I${prefix}/include CFLAGS=-I${prefix}/include

configure.post_args	--without-mng --disable-print

post-destroot	{ system "rm ${destroot}${prefix}/bin/gimp"
		  set script [open "${destroot}${prefix}/bin/gimp" w 0755]
		  puts $script "#!/bin/sh"
		  puts $script \
		  "export DYLD_INSERT_LIBRARIES=${prefix}/lib/libintl.dylib"
		  puts $script "${prefix}/bin/gimp-1.2 --no-shm --no-xshm"
		  close $script }
destroot.destdir prefix=${destroot}${prefix}
