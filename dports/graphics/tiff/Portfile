PortSystem 1.0
name		tiff
version		3.5.7
set libver	3
categories	graphics
maintainers	eric@opendarwin.org
description	Library and tools for dealing with Tag Image File Format
long_description	This software provides support for the Tag Image File Format (TIFF), a \
			widely used format for storing image data. \
			Included in this software distribution is a library, libtiff, for \
			reading and writing TIFF, a small collection of tools for doing simple \
			manipulations of TIFF images on UNIX systems, and documentation on the \
			library and tools. A small assortment of TIFF-related software for \
			UNIX that has been contributed by others is also included. \
			The library is capable of dealing with images that are written to \
			follow the 5.0 or 6.0 TIFF spec.  There is also considerable support \
			for some of the more esoteric portions of the 6.0 TIFF spec.

platforms	darwin
master_sites	ftp://ftp.remotesensing.org/pub/libtiff/
distname	${portname}-v${portversion}
checksums	md5 82243b5ae9b7c9e492aeebc501680990
depends_lib	lib:libjpeg.9:jpeg

configure.env	MANPATH=${prefix}/man
configure.args	--with-ZIP --with-JPEG --with-DIR_GZLIB=/usr/lib \
		--with-DIR_JPEGLIB=${prefix}/lib \
		--with-DIRS_LIBINC=${prefix}/include \
		--with-LIBGL=no --with-LIBIMAGE=no \
		--with-INSTALL="/bin/sh ${worksrcpath}/port/install.sh" \
		--noninteractive

post-build	{ cd ${worksrcpath}/libtiff
		  system "cc -dynamiclib -all_load \
		  -install_name ${prefix}/lib/libtiff.${portversion}.dylib \
		  -compatibility_version ${portversion} \
		  -o libtiff.${portversion}.dylib libtiff.a -L${prefix}/lib \
		  -ljpeg -lz" }

post-install	{ system "rm ${prefix}/lib/libtiff.a"
		  cd ${worksrcpath}/libtiff
		  system "install -o root -m 755 -d ${prefix}/lib"
		  system "install -o root -m 644 -c \
		  libtiff.${portversion}.dylib ${prefix}/lib"
		  system "ln -sf libtiff.${portversion}.dylib \
		  ${prefix}/lib/libtiff.${libver}.dylib"
		  system "ln -sf libtiff.${portversion}.dylib \
		  ${prefix}/lib/libtiff.dylib" }

include		contents
