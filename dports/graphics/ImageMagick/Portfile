# $Id: Portfile,v 1.6 2004/03/02 22:12:32 blb Exp $

PortSystem		1.0
name			ImageMagick
version			5.5.6
revision		3
categories		graphics
maintainers		blb@pobox.com
description		Tools and libraries to manipulate images in many formats
long_description \
	A robust collection of tools and libraries to read, write, and \
	manipulate an image in many image formats (over 87 major formats) \
	including popular formats like TIFF, JPEG, PNG, PDF, PhotoCD, and GIF.  \
	With ImageMagick you can create images dynamically, making it suitable \
	for Web applications. You can also resize, rotate, sharpen, color \
	reduce, or add special effects to an image or image sequence and save \
	your completed work in the same or differing image format. Image \
	processing operations are available from the command line, as well as \
	through C, C++, Perl, or Java programming interfaces.

platforms		darwin

homepage		http://www.imagemagick.org/
master_sites	sourceforge:imagemagick \
				ftp://ftp.imagemagick.org/pub/${name}/ \
				ftp://ftp.imagemagick.net/pub/${name}/ \
				ftp://ftp.nluug.nl/pub/${name}/
use_bzip2		yes
checksums		md5 eac3971f0704059dcf2f7a5737b7daa8

configure.env	CPPFLAGS="-I${prefix}/include" LDFLAGS="-L${prefix}/lib"
configure.args	--enable-shared --disable-static --without-perl --with-x \
				--with-dps --with-ttf --with-bzlib --without-fpx \
				--without-gslib --without-jbig --with-jpeg --without-jp2 \
				--without-lcms --with-png --with-tiff --without-wmf \
				--without-xml --with-zlib --mandir=${prefix}/share/man

depends_build	lib:libX11.6:XFree86 lib:libbz2:bzip2 lib:libjpeg:jpeg \
				lib:libpng:libpng lib:libtiff:tiff lib:libz:zlib

variant gs {
	depends_lib-append		lib:libgs:ghostscript
	configure.args-delete	--without-gslib
	configure.args-append	--with-gslib
}

variant lcms {
	depends_lib-append		lib:liblcms:lcms
	configure.args-delete	--without-lcms
	configure.args-append	--with-lcms
}

variant wmf {
	depends_lib-append		lib:libwmf:libwmf
	configure.args-delete	--without-wmf
	configure.args-append	--with-wmf
}

variant xml {
	depends_lib-append		lib:libxml:libxml2
	configure.args-delete	--without-xml
	configure.args-append	--with-xml
}

variant mpeg {
	depends_lib-append	bin:mpeg2encode:mpeg2vidcodec \
						bin:mpeg2decode:mpeg2vidcodec
}

variant jbig {
	depends_lib-append		lib:libjbig:jbigkit
	configure.args-delete	--without-jbig
	configure.args-append	--with-jbig
}

variant jpeg2 {
	depends_lib-append		lib:libjasper:jasper
	configure.args-delete	--without-jp2
	configure.args-append	--with-jp2
}

variant no-plus-plus {
	configure.args-append	--without-magick-plus-plus
}

variant darwin {
	patchfiles-append	patch-ltmain.sh
}

# Darwin 7 has poll() but it hates NULL for the first arg, so disable poll()
# use
platform darwin 7 {
	patchfiles-append	patch-configure_darwin7
}

