# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                hexchat
version             2.9.5
set branch          [join [lrange [split ${version} .] 0 1] .]
categories          irc
maintainers         raimue \
                    openmaintainer
description         IRC client based on XChat
homepage            http://hexchat.github.io/
platforms           darwin
license             GPL-2+

long_description \
    HexChat is a graphical IRC client using GTK2 that has \
    many features and can be scripted with Perl and/or Python. \
    It is based on XChat, but unlike its predecessor completely \
    free software.

master_sites        http://dl.hexchat.net/hexchat/
use_xz yes

checksums           rmd160  c3c3c0b777853e6f3984dae99c60e149a5ffef9b \
                    sha256  11dfd0fbfb88d8dbb38f631fab8a7dffbb179f7f7dafe316953ed6f513ac623d

depends_build       port:pkgconfig
depends_lib         port:gtk2 \
                    port:libsexy \
                    path:bin/perl:perl5 \
                    port:libpng \
                    port:libnotify

#patchfiles          patch-gtk2.19.7.diff patch-glib-2.32.diff patch-gmodule.diff

patchfiles          patch-cflags.diff \
                    patch-gobject.diff \
                    patch-nls.diff \
                    patch-strptime.diff
patch.pre_args      -p1

#post-extract {
#    system "touch ${worksrcpath}/NEWS"
#    system "touch ${worksrcpath}/ABOUT-NLS"
#}

use_autoreconf        yes

configure.args      --disable-dependency-tracking \
                    --disable-python \
                    --disable-mmx \
                    --enable-ipv6 \
                    --disable-openssl \
                    --enable-libnotify \
                    --enable-spell=libsexy \
                    --enable-socks

# gettextize has not been run on the distributed tarball and cannot be run non-interactively
configure.args-append --disable-nls
universal_variant   no

default_variants    +ssl

variant xft conflicts quartz description "Enable Xft2 font support" {
    configure.args-append --enable-xft
}

variant ssl description "Enable SSL using openssl" {
    configure.args-delete --disable-openssl
    configure.args-append --enable-openssl
    depends_lib-append port:openssl
}

variant quartz conflicts xft {
    configure.args-append --disable-xlib
}

variant python25 description "Enable Python plugin, using python25" conflicts python26 python27 {
    configure.args-delete --disable-python
    configure.args-append --enable-python
    depends_lib-append port:python25
    configure.env pythonpath="${prefix}/bin/python2.5"
}

variant python26 description "Enable Python plugin, using python26" conflicts python25 python27 {
    configure.args-delete --disable-python
    configure.args-append --enable-python
    depends_lib-append port:python26
    configure.env pythonpath="${prefix}/bin/python2.6"
}

variant python27 description "Enable Python plugin, using python27" conflicts python25 python26 {
    configure.args-delete --disable-python
    configure.args-append --enable-python
    depends_lib-append port:python27
    configure.env pythonpath="${prefix}/bin/python2.7"
}

livecheck.type  regex
livecheck.url   http://hexchat.github.io/downloads.html
livecheck.regex ${name}-(\\d+(\\.\\d+)+)\\.tar
