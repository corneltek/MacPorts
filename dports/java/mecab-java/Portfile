# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                mecab-java
version             0.993
epoch               1
categories          java textproc japanese
platforms           darwin
maintainers         hum openmaintainer
license             GPL-2 LGPL-2.1 BSD

description         a Java module for MeCab
long_description    ${name} is ${description}.

homepage            http://mecab.sourceforge.net/
master_sites        googlecode:mecab
checksums           rmd160  73ad41677b1e86414732b24b86943a2148b991c5 \
                    sha256  4631ddbc8f57b749d0bed0573217e336e981bece37c89dfb5021697e897ea94a

dist_subdir         mecab

depends_lib         port:mecab-utf8

patchfiles          patch-Makefile.diff \
                    patch-test.java.diff

set mecab_java_home ${prefix}/share/doc/${name}
set jar_home        ${prefix}/share/java
set mecab_jar       ${jar_home}/mecab.jar

post-patch {
    reinplace "s|@java_library_path@|${prefix}/lib|g" ${worksrcpath}/test.java
}

use_configure       no

variant universal   {}

build.args          CXX="${configure.cxx}" \
                    CXXFLAGS="${configure.cxxflags} [get_canonical_archflags cxx]"

test.run            yes

destroot    {
    xinstall -m 755 -d \
        ${destroot}${jar_home} \
        ${destroot}${mecab_java_home}
    xinstall -m 644 -W ${worksrcpath} \
        AUTHORS BSD COPYING GPL LGPL bindings.html test.java test.class \
        ${destroot}${mecab_java_home}
    xinstall -m 755 ${filespath}/test.sh \
        ${destroot}${mecab_java_home}
    reinplace "s|@java_library_path@|${prefix}/lib|g"    ${destroot}${mecab_java_home}/test.sh
    reinplace "s|@cp@|${mecab_java_home}:${mecab_jar}|g" ${destroot}${mecab_java_home}/test.sh
    xinstall -m 644 ${worksrcpath}/MeCab.jar \
        ${destroot}${mecab_jar}
    xinstall -m 644 ${worksrcpath}/lib${name}.dylib \
        ${destroot}${prefix}/lib
}

livecheck.type      regex
livecheck.url       http://code.google.com/p/mecab/downloads/list
livecheck.regex     {mecab-java-([\d\.]+)\.tar}
