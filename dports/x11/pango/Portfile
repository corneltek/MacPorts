# $Id: Portfile,v 1.11 2003/05/22 16:18:20 mij Exp $

PortSystem 1.0
name		pango
version		1.0.5
revision	2
categories	x11
maintainers	mij@opendarwin.org
description	Framework for the layout and rendering of i18n text
platforms	darwin

long_description The goal of the Pango project is to provide an \
		 open-source framework for the layout and rendering \
		 of internationalized text.

master_sites	ftp://ftp.gtk.org/pub/gtk/v2.0/

checksums	md5 e300e5c163bc28e180e45c8e20543b4b

use_bzip2	yes

patchfiles	patch-Makefile.in patch-configure patch-ltmain.sh \
		patch-modules-arabic-Makefile.in \
		patch-modules-basic-Makefile.in \
		patch-modules-hangul-Makefile.in \
		patch-modules-hebrew-Makefile.in \
	 	patch-modules-indic-Makefile.in \
		patch-modules-tamil-Makefile.in \
		patch-modules-thai-Makefile.in patch-pango-Makefile.in \
		patch-pango-pangoft2.c patch-pango-pangoxft-font.c

depends_lib	lib:libglib.2:glib2 lib:libX11.6:XFree86

configure.env	LDFLAGS="-L${prefix}/lib -L${x11prefix}/lib -no-undefined" \
		CFLAGS="-O3 -fstrict-aliasing -funroll-loops -pipe" \
		CPPFLAGS="-I${prefix}/include -I${x11prefix}/include \
		-no-cpp-precomp" 

post-install	{ system "ln -fs libpango-1.0.0.0.5.dylib \
		    ${destroot}${prefix}/lib/libpango.1.dylib"
		  system "ln -fs libpangox-1.0.0.0.5.dylib \
		    ${destroot}${prefix}/lib/libpangox.1.dylib"
		  reinplace "s|\./|${prefix}/etc/pango/|g" \
		    ${worksrcpath}/examples/pangorc
		  reinplace "s|\./|${prefix}/etc/pango/|g" \
		    ${worksrcpath}/examples/pangox.aliases
		  system "install -o root -m 755 -d \
		    ${destroot}${prefix}/etc/pango"
		  system "cp ${worksrcpath}/examples/pangorc \
		    ${destroot}${prefix}/etc/pango"
		  system "cp ${worksrcpath}/examples/pangox.aliases \
		    ${destroot}${prefix}/etc/pango" 
		  system "env LANG=C DYLD_LIBRARY_PATH=${destroot}${prefix}/lib \
		    ${destroot}${prefix}/bin/pango-querymodules ${destroot}${prefix}/lib/pango/1.0.0/modules/* >${destroot}${prefix}/etc/pango/pango.modules"
		  reinplace s|${destroot}||g ${destroot}${prefix}/etc/pango/pango.modules }
