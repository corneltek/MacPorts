Index: arts/knotify/Makefile.am
===================================================================
RCS file: /home/kde/kdelibs/arts/knotify/Makefile.am,v
retrieving revision 1.19
diff -u -b -u -r1.19 Makefile.am
--- arts/knotify/Makefile.am	27 Mar 2003 11:43:38 -0000	1.19
+++ arts/knotify/Makefile.am	16 Jun 2003 14:05:39 -0000
@@ -3,18 +3,29 @@
 
 ####### Files
 
+lib_LTLIBRARIES = libknotify_main.la knotify.la
 bin_PROGRAMS	= knotify
-lib_LTLIBRARIES = knotify.la
 
-knotify_la_SOURCES	= knotify.cpp knotify.skel
-knotify_la_LIBADD	= -lsoundserver_idl -lqtmcop $(LIB_KDEUI) $(top_builddir)/arts/kde/libartskde.la
+libknotify_main_la_SOURCES	= knotify.cpp knotify.skel
+libknotify_main_la_LIBADD	= -lsoundserver_idl -lqtmcop $(LIB_KDEUI) $(top_builddir)/arts/kde/libartskde.la
+libknotify_main_la_LDFLAGS	= $(all_libraries) -avoid-version -no-undefined
+libknotify_main_la_METASOURCES	= AUTO
+
+knotify_la_SOURCES	= knotify_la_main.cpp
+knotify_la_LIBADD	= libknotify_main.la
 knotify_la_LDFLAGS = $(all_libraries) -module -avoid-version
 knotify_la_METASOURCES = AUTO
 
-knotify_SOURCES = dummy.cpp
-knotify_LDADD = knotify.la
+knotify_la_main.cpp: stub_main.cpp
+	cat stub_main.cpp > knotify_la_main.cpp
+
+knotify_SOURCES	= knotify_main.cpp
+knotify_LDADD	= libknotify_main.la
 knotify_LDFLAGS  = $(all_libraries) $(KDE_RPATH)
 
+knotify_main.cpp: stub_main.cpp
+	cat stub_main.cpp > knotify_main.cpp
+
 check_PROGRAMS		= knotifytest
 knotifytest_SOURCES	= knotifytest.cpp
 knotifytest_LDADD	= $(LIB_KDECORE)
@@ -28,5 +39,3 @@
 messages:
 	$(XGETTEXT) knotify.cpp -o $(podir)/knotify.pot
 
-dummy.cpp:
-	echo > dummy.cpp
