--- kolf/Makefile.am	29 Oct 2002 15:53:13 -0000	1.1.1.3
+++ kolf/Makefile.am	1 Jun 2003 14:31:58 -0000	1.8
@@ -1,17 +1,17 @@
 SUBDIRS = objects sounds courses pics graphics
 INCLUDES = -I$(top_srcdir) -I$(top_srcdir)/libkdegames $(all_includes)
 
-lib_LTLIBRARIES = libkolf.la
+lib_LTLIBRARIES = libkolf_shared.la
 bin_PROGRAMS = kolf
 
-libkolf_la_SOURCES = \
+libkolf_shared_la_SOURCES = \
 	kolf.cpp game.cpp canvasitem.cpp ball.cpp newgame.cpp config.cpp \
 	scoreboard.cpp editor.cpp pluginloader.cpp object.cpp vector.cpp \
 	printdialogpage.cpp kcomboboxdialog.cpp kvolumecontrol.cpp \
 	floater.cpp slope.cpp
 
-libkolf_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -export-dynamic
-libkolf_la_LIBADD = $(LIB_KDEGAMES) $(LIB_KDEPRINT) $(LIB_KIO) -lartskde
+libkolf_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -export-dynamic -avoid-version -no-undefined
+libkolf_shared_la_LIBADD = $(LIB_KDEGAMES) $(LIB_KDEPRINT) $(LIB_KIO) -lartskde -lsoundserver_idl -lmcop -lartsflow_idl -lkdeprint
 
 # the installed header files
 kolfinclude_HEADERS = \
@@ -24,17 +24,16 @@
 # kdeinited lib
 kde_module_LTLIBRARIES = kolf.la
 kolf_la_SOURCES = main.cpp
-kolf_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -module -avoid-version
-kolf_la_LIBADD = libkolf.la
-
+kolf_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -avoid-version -module
+kolf_la_LIBADD = libkolf_shared.la
 
 # the empty "stub" app that has nothing
-kolf_SOURCES = dummy.cpp
+kolf_SOURCES = kolf_main.cpp
 kolf_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kolf_LDADD   = kolf.la
+kolf_LDADD   = libkolf_shared.la
 
-dummy.cpp:
-	echo > dummy.cpp
+kolf_main.cpp: main.cpp
+	cat main.cpp > kolf_main.cpp
 
 EXTRA_DIST = kolf.desktop
 
