Index: konsole/konsole/Makefile.am
===================================================================
RCS file: /home/kde/kdebase/konsole/konsole/Makefile.am,v
retrieving revision 1.56
diff -u -b -u -r1.56 Makefile.am
--- konsole/konsole/Makefile.am	9 Apr 2003 12:48:28 -0000	1.56
+++ konsole/konsole/Makefile.am	17 Jun 2003 03:48:50 -0000
@@ -5,10 +5,10 @@
 
 # you can add here more. This one gets installed
 bin_PROGRAMS = 	konsole kwrited #kcmkonsole
-lib_LTLIBRARIES = kwrited.la konsole.la
+lib_LTLIBRARIES = libkonsolepart_shared.la libkwrited_main.la libkonsole_main.la
 
-kde_module_LTLIBRARIES = libkonsolepart.la
-libkonsolepart_la_SOURCES = TEPty.cpp BlockArray.cpp konsole_part.cpp \
+kde_module_LTLIBRARIES = libkonsolepart.la kwrited.la konsole.la
+libkonsolepart_shared_la_SOURCES = TEPty.cpp BlockArray.cpp konsole_part.cpp \
 	schema.cpp \
 	session.cpp \
 	zmodem_dialog.cpp \
@@ -21,33 +21,60 @@
 	konsoleiface.skel \
         sessioniface.skel
 
-libkonsolepart_la_LDFLAGS = $(KDE_PLUGIN) $(all_libraries)
-libkonsolepart_la_LIBADD = $(XTESTLIB) $(LIB_KPARTS)
+libkonsolepart_shared_la_LDFLAGS = $(KDE_RPATH) $(all_libraries)
+libkonsolepart_shared_la_LIBADD = $(XTESTLIB) $(LIB_KPARTS)
+
+libkonsolepart_la_SOURCES = dummy.cpp
+libkonsolepart_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+libkonsolepart_la_LIBADD  = libkonsolepart_shared.la
+
+dummy.cpp:
+	echo > dummy.cpp
 
 # kwrited kdeinit module
-kwrited_la_SOURCES = kwrited.cpp TEPty.cpp
-kwrited_la_LIBADD  = $(LIB_KDECORE) 
-kwrited_la_LDFLAGS = $(all_libraries) -module -avoid-version
+
+libkwrited_main_la_SOURCES = kwrited.cpp TEPty.cpp
+libkwrited_main_la_LIBADD  = $(LIB_KDECORE) 
+libkwrited_main_la_LDFLAGS = $(all_libraries) -avoid-version
+
+kwrited_la_SOURCES = kwrited_la_main.cpp
+kwrited_la_LDFLAGS = $(all_libraries) -avoid-version -module
+kwrited_la_LIBADD  = libkwrited_main.la
+
+kwrited_la_main.cpp: stub_main.cpp
+	cat stub_main.cpp > kwrited_la_main.cpp
 
 # kwrited executable
-kwrited_SOURCES	= dummy.cpp
-kwrited_LDADD   = kwrited.la 
+kwrited_SOURCES	= kwrited_main.cpp
+kwrited_LDADD   = libkwrited_main.la 
 kwrited_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 
+kwrited_main.cpp: stub_main.cpp
+	cat stub_main.cpp > kwrited_main.cpp
 
 # konsole kdeinit module
-konsole_la_SOURCES = TEPty.cpp BlockArray.cpp main.cpp konsole.cpp schema.cpp session.cpp TEWidget.cpp TEmuVt102.cpp \
+libkonsole_main_la_SOURCES = TEPty.cpp BlockArray.cpp main.cpp konsole.cpp schema.cpp session.cpp TEWidget.cpp TEmuVt102.cpp \
      TEScreen.cpp TEmulation.cpp TEHistory.cpp keytrans.cpp konsoleiface.skel sessioniface.skel \
      konsole_wcwidth.cpp konsolebookmarkhandler.cpp konsolebookmarkmenu.cpp konsole_child.cpp \
      zmodem_dialog.cpp printsettings.cpp
-konsole_la_LDFLAGS = $(all_libraries) -module -avoid-version
-konsole_la_LIBADD = $(LIB_KDEUI) $(LIB_KIO) $(LIB_KDEPRINT) $(LIBUTIL) $(XTESTLIB)
+libkonsole_main_la_LDFLAGS = $(all_libraries) -avoid-version
+libkonsole_main_la_LIBADD = $(LIB_KDEUI) $(LIB_KIO) $(LIB_KDEPRINT) $(LIBUTIL) $(XTESTLIB)
+
+konsole_la_SOURCES = konsole_la_main.cpp
+konsole_la_LDFLAGS = $(all_libraries) -avoid-version -module
+konsole_la_LIBADD  = libkonsole_main.la
+
+konsole_la_main.cpp: stub_main.cpp
+	cat stub_main.cpp > konsole_la_main.cpp
 
 # konsole executable
-konsole_SOURCES = dummy.cpp
-konsole_LDADD = konsole.la $(LIB_KDEPRINT)
+konsole_SOURCES = konsole_main.cpp
+konsole_LDADD   = libkonsole_main.la $(LIB_KDEPRINT)
 konsole_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 
+konsole_main.cpp: stub_main.cpp
+	cat stub_main.cpp > konsole_main.cpp
+
 # kcmkonsole_SOURCES = kcmkonsole.cpp schema.cpp
 # kcmkonsole_LDADD   = $(LIB_KDEUI)
 # kcmkonsole_LDFLAGS = $(all_libraries) $(KDE_RPATH)
@@ -76,9 +103,6 @@
 	$(XGETTEXT) rc.cpp *.cpp -o $(podir)/konsole.pot
 	rm -f schemas.cpp
 	rm -f tips.cpp
-
-dummy.cpp:
-	echo > dummy.cpp
 
 # setting up x-application/konsole as a special mimetype
 mimedir = $(kde_mimedir)/application
