Index: kview/Makefile.am
===================================================================
RCS file: /home/kde/kdegraphics/kview/Makefile.am,v
retrieving revision 1.86
diff -u -b -u -r1.86 Makefile.am
--- kview/Makefile.am	28 Feb 2003 00:25:16 -0000	1.86
+++ kview/Makefile.am	19 Jun 2003 02:06:04 -0000
@@ -5,17 +5,25 @@
 METASOURCES = AUTO
 
 bin_PROGRAMS = kview
-lib_LTLIBRARIES = kview.la
+kde_module_LTLIBRARIES = kview.la
+lib_LTLIBRARIES = libkview_main.la
 
 noinst_HEADERS = kview.h
 
-kview_SOURCES = dummy.cpp
+kview_SOURCES = main.cpp
 kview_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kview_LDADD = kview.la
+kview_LDADD = libkview_main.la
 
-kview_la_SOURCES = kviewconfmodules.cpp kview.cpp main.cpp
+libkview_main_la_SOURCES = kviewconfmodules.cpp kview.cpp
+libkview_main_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -avoid-version
+libkview_main_la_LIBADD = $(LIB_KPARTS)
+
+kview_la_SOURCES = kview_la_main.cpp
 kview_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -module -avoid-version
-kview_la_LIBADD = $(LIB_KPARTS)
+kview_la_LIBADD  = libkview_main.la
+
+kview_la_main.cpp: main.cpp
+	cat main.cpp > kview_la_main.cpp
 
 xdg_apps_DATA = kview.desktop
 
@@ -27,6 +35,3 @@
 messages: rc.cpp
 	$(EXTRACTRC) kviewviewer/*.rc kviewviewer/*.ui >> rc.cpp
 	$(XGETTEXT) kviewviewer/*.cpp kviewcanvas/*.cpp *.cpp *.h -o $(podir)/kview.pot
-
-dummy.cpp:
-	echo > dummy.cpp
