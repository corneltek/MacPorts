Index: kuickshow/src/Makefile.am
===================================================================
RCS file: /home/kde/kdegraphics/kuickshow/src/Makefile.am,v
retrieving revision 1.10
diff -u -b -u -r1.10 Makefile.am
--- kuickshow/src/Makefile.am	28 Feb 2003 00:25:16 -0000	1.10
+++ kuickshow/src/Makefile.am	19 Jun 2003 01:54:15 -0000
@@ -1,25 +1,33 @@
 ## Makefile.am for kuickshow
 
 bin_PROGRAMS = kuickshow
-lib_LTLIBRARIES = kuickshow.la
+lib_LTLIBRARIES = kuickshow.la libkuickshow_main.la
 
 # set the include path for X, qt and KDE
 INCLUDES = $(all_includes)
 KDE_CXXFLAGS = $(IMLIB_CFLAGS)
-CLEANFILES = dummy.cpp
+CLEANFILES = kuickshow_la_main.cpp
 METASOURCES = AUTO
 
-kuickshow_la_LDFLAGS = $(all_libraries) -module -avoid-version
-kuickshow_la_LIBADD  = $(LIB_KDEPRINT) $(LIB_IMLIB)
-kuickshow_la_SOURCES =	kuickshow.cpp \
-	aboutwidget.cpp     generalwidget.cpp  kuickconfigdlg.cpp  main.cpp \
+libkuickshow_main_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined
+libkuickshow_main_la_LIBADD  = -lkdeprint $(LIB_IMLIB) $(LIB_KDECORE) \
+	$(LIB_KDEUI) $(LIB_KIO) $(LIB_QT) $(LIB_KDEFX)
+libkuickshow_main_la_SOURCES =	kuickshow.cpp \
+	aboutwidget.cpp     generalwidget.cpp  kuickconfigdlg.cpp \
 	defaultswidget.cpp  imagewindow.cpp    kuickdata.cpp  \
 	imdata.cpp filefinder.cpp kurlwidget.cpp filewidget.cpp \
 	kuickio.cpp kuick.cpp imlibwidget.cpp slideshowwidget.cpp printing.cpp
 
+kuickshow_la_SOURCES = kuickshow_la_main.cpp
+kuickshow_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+kuickshow_la_LIBADD  = libkuickshow_main.la
+
+kuickshow_la_main.cpp: main.cpp
+	cat main.cpp > kuickshow_la_main.cpp
+
 # now the kuickshow binary
-kuickshow_LDADD = kuickshow.la $(LIB_KIO) $(LIB_IMLIB)
-kuickshow_SOURCES = dummy.cpp
+kuickshow_LDADD = libkuickshow_main.la
+kuickshow_SOURCES = main.cpp
 kuickshow_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 
 
