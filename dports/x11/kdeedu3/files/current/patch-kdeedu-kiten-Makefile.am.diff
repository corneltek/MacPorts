--- kiten/Makefile.am	5 Nov 2002 19:59:22 -0000	1.1.1.4
+++ kiten/Makefile.am	1 Jun 2003 14:31:57 -0000	1.5
@@ -2,27 +2,33 @@
 
 SUBDIRS = pics
 
-lib_LTLIBRARIES = kiten.la
+lib_LTLIBRARIES = kiten.la libkiten_main.la
 
-kiten_la_SOURCES = 	main.cpp \
-				dict.cpp \
-				kiten.cpp \
-				optiondialog.cpp \
-				rad.cpp \
-				deinf.cpp \
-				kromajiedit.cpp \
-				widgets.cpp \
-				learn.cpp \
-				kloader.cpp \
-				ksaver.cpp
+libkiten_main_la_SOURCES = dict.cpp \
+	kiten.cpp \
+	optiondialog.cpp \
+	rad.cpp \
+	deinf.cpp \
+	kromajiedit.cpp \
+	widgets.cpp \
+	learn.cpp \
+	kloader.cpp \
+	ksaver.cpp
+libkiten_main_la_LIBADD = $(LIB_QT) $(LIB_KDEUI) $(LIB_KIO) $(LIB_KDECORE) -lkdeprint
+libkiten_main_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -no-undefined
 
-kiten_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+kiten_la_SOURCES = kiten_la_main.cpp
+kiten_la_LIBADD  = libkiten_main.la
+kiten_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -module
+
+kiten_la_main.cpp: main.cpp
+	cat main.cpp > kiten_la_main.cpp
 
 bin_PROGRAMS = kiten kitengen
 
-kiten_LDADD = kiten.la $(KDE_RPATH) $(LIB_KDEUI) $(LIB_KIO) $(LIB_KDEPRINT)
+kiten_LDADD = libkiten_main.la
 kiten_LDFLAGS = $(all_libraries)
-kiten_SOURCES = dummy.cpp
+kiten_SOURCES = main.cpp
 
 kitengen_SOURCES = xjdxgen.c
 kitengen_LDFLAGS = $(all_libraries) $(KDE_RPATH) $(LIB_QT)
