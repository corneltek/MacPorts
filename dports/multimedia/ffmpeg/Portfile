# $Id: Portfile,v 1.1 2004/01/29 04:48:09 blb Exp $

PortSystem 1.0
name		ffmpeg
version		0.4.8
categories	multimedia
maintainers	ocheron@noos.fr
description	Digital VCR and streaming server
long_description	FFmpeg is a complete solution to record, convert and \
			stream audio and video. It includes libavcodec, the \
			leading audio/video codec library. \
			\
			The project is made of several components: \
			\
			ffmpeg is a command line tool to convert one video \
			file format to another. It also supports grabbing and \
			encoding in real time from a TV card. \
			\
			ffserver is an HTTP (RTSP is being developped) \
			multimedia streaming server for live broadcasts. Time \
			shifting of live broadcast is also supported. \
			\
			ffplay is a simple media player based on SDL and on \
			the ffmpeg libraries. \
			\
			libavcodec is a library containing all the ffmpeg \
			audio/video encoders and decoders. Most codecs were \
			developped from scratch to ensure best performances \
			and high code reusability. \
			\
			libavformat is a library containing parsers and \
			generators for all common audio/video formats.
homepage        http://ffmpeg.sourceforge.net/
master_sites	sourceforge:ffmpeg
checksums	${distname}${extract.suffix} md5 e00d47614ba1afd99ad2ea387e782dd9
platforms       darwin
configure.env	CFLAGS="-I${prefix}/include"
configure.args	--prefix=${destroot}${prefix} --disable-vhook \
		--mandir=${destroot}${prefix}/share/man \
		--extra-ldflags="-d -L${prefix}/lib"
patchfiles	patch-configure.diff

post-destroot {
	file mkdir ${destroot}/${prefix}/share/doc/${name}
	file copy ${worksrcpath}/doc/TODO ${destroot}/${prefix}/share/doc/${name}
	foreach f [glob ${worksrcpath}/doc/*.txt ${worksrcpath}/doc/*.html] {
		file copy $f ${destroot}/${prefix}/share/doc/${name}
	}
}

# Adds MP3 support
variant mp3 {
	depends_lib-append lib:mp3lame:lame
	configure.args-append --enable-mp3lame
}

# Adds Ogg Vorbis support
variant ogg-vorbis {
	depends_lib-append lib:vorbis:libvorbis lib:vorbisenc:libvorbis lib:ogg:libogg
	configure.args-append --enable-vorbis
}

# Adds AAC support
variant aac {
	depends_lib-append lib:faad:faad2
	configure.args-append --enable-faad
}
