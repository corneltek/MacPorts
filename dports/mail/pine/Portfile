# $Id: Portfile,v 1.6 2003/03/03 06:59:15 mij Exp $

PortSystem         1.0
name               pine
version            4.44
categories         mail
maintainers        \[Fink\] Jeffrey Whitaker <jsw@cdc.noaa.gov> / \[DarwinPorts\] Sean Brandt <sean@fuzzymagic.com>
description        Text based tool for reading, sending, and managing emails.
long_description   Pine (Program for Internet News & Email) is a tool for reading, sending, \
		   and managing electronic messages.  It was designed specifically with \
		   novice computer users in mind, but can be tailored to accommodate the \
		   needs of "power users" as well.  Pine uses Internet message protocols \
		   (e.g. RFC-822, SMTP, MIME, IMAP, NNTP) and runs on Unix and PCs.

master_sites       ftp://ftp.cac.washington.edu/pine/old/ ftp://ftp.cac.washington.edu/pine/ 
distname           ${name}${portversion}
extract.sufx       .tar.Z
set buildssl       NOSSL
set buildargs      "EXTRACFLAGS=-I${prefix}/include EXTRALDFLAGS=-L${prefix}/lib  DEBUG=\"-g -O2 -DDEBUG\""
set patch.pre_args -p1
set installprog    "/usr/bin/install -o root -g admin"
patchfiles         makefile.osx.patch pine.hlp.patch pico-osdep-os-osx.h
checksums          md5 9887b2199602f9639361490c5bcc257d


configure {
   cd ${worksrcpath}
   reinplace "s|@PREFIX@|${prefix}|g" pico/makefile.osx
   reinplace "s|@PREFIX@|${prefix}|g" pine/pine.hlp
}

variant ssl {
    set buildssl    "SSLDIR=/System/Library/OpenSSL SSLINCLUDE=/usr/include/openssl SSLLIB=/usr/lib"
}

build              {
    cd ${worksrcpath}
    system "./build ${buildargs} ${buildssl} osx"
}

install {
    cd ${worksrcpath}
    system "${installprog} -d ${destroot}${prefix}/bin ${prefix}/sbin"
    system "${installprog} -d ${destroot}${prefix}/share/man/man1"
    system "${installprog} -d ${destroot}${prefix}/share/doc/${name}/html"
    system "${installprog} -d ${destroot}${prefix}/etc"
    system "${installprog} -c bin/pine ${destroot}${prefix}/bin"
    system "${installprog} -c bin/pico ${destroot}${prefix}/bin"
    system "${installprog} -c bin/pilot ${destroot}${prefix}/bin"
    system "${installprog} -c bin/mtest ${destroot}${prefix}/bin"
    system "${installprog} -c bin/imapd ${destroot}${prefix}/sbin"
    system "${installprog} -c imap/ipopd/ipop2d ${destroot}${prefix}/sbin"
    system "${installprog} -c imap/ipopd/ipop3d ${destroot}${prefix}/sbin"
    system "${installprog} -c doc/pine.1 ${destroot}${prefix}/share/man/man1"
    system "${installprog} -c doc/pico.1 ${destroot}${prefix}/share/man/man1"
    system "${installprog} -c doc/pilot.1 ${destroot}${prefix}/share/man/man1"
    system "${installprog} -c doc/tech-notes/*.html ${destroot}${prefix}/share/doc/${name}/html"
    system "${destroot}${prefix}/bin/pine -conf > ${destroot}${prefix}/etc/pine.conf "
}

