# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           cmake   1.0
PortGroup           github  1.0

categories          gis
maintainers         vince
description         SFCGAL links CGAL to PostGIS
long_description    SFCGAL (“Simple Features for CGAL”)\
                    is a library that provides a SF-SQL API\
                    to some CGAL routines, thereby enabling spatial\
                    databases such as PostGIS to rely on CGAL to\
                    perform 2D and 3D geometry operations (union,\
                    intersections, buffering, etc.).

platforms           darwin
license             LGPL-2

homepage            http://www.sfcgal.org/

github.setup        Oslandia SFCGAL 1.0.1 v
name                sfcgal

checksums           rmd160  3b20469d4bf5e4d6e457dd798186b1b9ba3af2e3 \
                    sha256  e877fc129414a448e0a968be7ede5121bfd23ee67f6f49bbdc9c3b59edae6c34

depends_lib-append  port:cgal \
                    port:mpfr \
                    port:gmp 

# Variants

variant viewer description {builds a Qt4-based viewer} {

    PortGroup               qt4 1.0
    depends_lib-append      port:openscenegraph
    configure.args-append   -DSFCGAL_BUILD_VIEWER=ON
}

variant examples description {builds examples} {

    configure.args-append   -DSFCGAL_BUILD_EXAMPLES=ON
}

post-configure {
    if {[variant_isset viewer]} {
        reinplace -E "s|(.*)|\\1 -F ${frameworks_dir} -lQtCore -lQtOpenGL -lQtGui|" \
            ${worksrcpath}/viewer/CMakeFiles/viewer-SFCGAL.dir/link.txt
    }
}

use_parallel_build  yes

post-destroot {
    delete ${destroot}${prefix}/include/CGAL
}
