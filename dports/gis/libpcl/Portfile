# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           cmake 1.0
PortGroup           github 1.0
PortGroup           active_variants 1.1

name                libpcl
version             1.7.0
categories          gis graphics science
platforms           darwin
license             BSD
maintainers         gmail.com:luminans vince
description         Point Cloud Library
long_description    The Point Cloud Library (PCL) is a standalone, large scale, open project \
                    for 2D/3D image and point cloud processing.

homepage            http://pointclouds.org

github.author
github.project      PointCloudLibrary
github.version      ${version}
github.master_sites https://github.com/PointCloudLibrary/pcl/archive
distname            pcl-${version}

extract.suffix      .zip
use_zip             yes

checksums           rmd160  2cbb28277d2bed5f9c633e7eee191f1e918287b4 \
                    sha256  3dddf5e7b1170f59d35152697a037cdd0fac66ab99c215271a3c4e6f3bfee367

worksrcdir          pcl-${distname}

depends_lib         port:boost \
                    port:eigen3 \
                    port:flann \
                    port:vtk5 \
                    port:qhull \
                    port:openni

pre-configure {
    if {![active_variants vtk5 "qt4_mac" ""]} {
        return -code error "VTK5 toolkit must be built over Qt4.\
                            Please reinstall with +qt4_mac variant."
    }
} 

configure.args-append   -DOPENNI_INCLUDE_DIR=${prefix}/include/ni
# PCL 1.6 does not compile with clang or macports-gcc-4.x
# https://trac.macports.org/ticket/37813
#compiler.whitelist  llvm-gcc-4.2 macports-llvm-gcc-4.2
variant perf description {Optimize code} {
    configure.compiler  macports-clang-3.3
    configure.optflags  -O3 -pipe -march=native -mavx
}

