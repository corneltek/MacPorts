# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                angband
version             3.5.0
set branch          [join [lrange [split ${version} .] 0 1] .]

categories          games
license             Noncommercial
platforms           darwin

maintainers         nomaintainer

description         a rogue-like dungeon exploration game (curses-based)
long_description    Angband is a freeware computer dungeon exploration game \
based (loosely) on the books of J.R.R.Tolkien. You explore a very deep \
dungeon, kill monsters, try to equip yourself with the best weapons and \
armor you can find, and finally face Morgoth - The Dark Enemy.

homepage            http://rephial.org

master_sites        http://rephial.org/downloads/${branch}

distfiles           ${name}-v${version}.tar.gz

checksums           rmd160  c017577796c8a3d9d1455108678118d2f137f020 \
                    sha256  3d3c3a8839ef97613d5e29c116c5e88c93b913485768106ad4906c75069085ec

worksrcdir          ${name}-v${version}

depends_lib-append  port:ncurses

post-patch {
    addgroup games
}

configure.args      --with-setgid=games --with-libpath=${prefix}/var/games/angband --bindir=${prefix}/bin --without-x

notes "
If you receive this error 'Angband requires UTF-8 support', you need to set
LANG to a valid UTF-8 language such as:
export LANG=en_US.UTF-8
"

variant x11 {
    depends_build-append  port:imake
    depends_lib-append lib:libXaw:xorg-libXaw
    configure.args-delete --without-x
    configure.args-append --with-x
}

# variant aqua        {
#                          distfiles-append ext-mac-306.zip:mac ext-graf-mac-306.zip:mac ext-sound-mac-306.zip:mac
#                          checksums-append ext-mac-306.zip md5 e8989e1c4acf9efb10e0ab078e7303f2 \
#                                           ext-graf-mac-306.zip md5 263d33545a8be198a4a014c73f581035 \
#                                           ext-sound-mac-306.zip md5 7886ff8cd9ac98bdfec50c50131c406e
#
#                          post-extract {
#                                          system "unzip ${distpath}/ext-mac-306.zip -d ${worksrcpath}/src/; \
#                                                  unzip ${distpath}/ext-graf-mac-306.zip -d ${worksrcpath}/src/; \
#                                                  unzip ${distpath}/ext-sound-mac-306.zip -d ${worksrcpath}/src/"
#                                       }
#
#                          configure { reinplace "s|# define SET_UID||" ${worksrcpath}/src/h-config.h }
#
#                          build {
#                                     cd ${worksrcpath}/src
#                                     system "make -f Makefile.osx; \
#                                             make -f Makefile.osx install-tiles; \
#                                             make -f Makefile.osx install-sound"
#                                }
#
#                          destroot { xinstall -d ${destroot}/Applications/MacPorts/
#                          system "cp -r ${worksrcpath}/Angband.app ${destroot}/Applications/MacPorts/." }
#                     }

