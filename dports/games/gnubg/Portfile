# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

PortGroup               active_variants 1.1

name                    gnubg
version                 1.02.000
categories              games
license                 GPL-3
platforms               darwin
maintainers             dtakahashi openmaintainer
homepage                http://www.gnubg.org/
description             GNU Backgammon

long_description        GNU Backgammon (gnubg) is a software for playing and analysing \
                        backgammon positions, games and matches. It's based on a neural \
                        network. Although it already plays at a very high level, it's \
                        still work in progress. You can play at GNU Backgammon using the \
                        command line or via a graphical interface based (on GTK+).

master_sites            http://files.gnubg.org/media/sources/
                        
distfiles               ${name}-release-${version}-sources.tar.gz
                        
checksums               ${name}-release-${version}-sources.tar.gz \
                        rmd160  15bfc5524fa6b92d8c60818a19632e029d1ebafb \
                        sha256  7ece7fc02481f8e6c08869306f1cf52cad9ec5ddd675de67782cf028a6dcb504

patchfiles              darwin-disable-canberra.configure.ac.diff

use_autoreconf          yes

depends_build           port:pkgconfig \
                        port:bison \
                        port:flex

depends_lib             port:gtk2 \
                        port:sqlite3 \
                        port:gmp \
                        port:libiconv \
                        port:freetype \
                        port:python27 \
                        port:readline

configure.args          --mandir=${prefix}/share/man \
                        --infodir=${prefix}/share/info \
                        --sysconfdir=${prefix}/etc \
                        --libdir=${prefix}/lib \
                        --with-python=${prefix}/bin/python \
                        --without-board3d \
                        --with-gtk2

notes \
"Recommended ports:
  py27-mysql    provides the MySQL backend of a game database
  py27-pygersql provides the PostgreSQL backend of a game database"

variant board3d description enable OpenGL board {
  depends_lib-append      port:gtkglext
  ## disable 3D board on the quartz variants
  ## because of the display issue
  ## see also https://mail.gnome.org/archives/gtkglext-list/2009-December/msg00023.html
  require_active_variants port:gtkglext {} quartz
  
  configure.args-delete   --without-board3d
  configure.args-append   --with-board3d
  
  ## gtkglext+x11 links to libgl that is provided by macports.
  ## Therefore, it should include macports' opengl headers
  ## instead of the ones provided by OSX
  configure.cflags-append -I${prefix}/include/GL
}
