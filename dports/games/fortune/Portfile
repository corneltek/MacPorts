PortSystem 1.0
name		fortune
version		4.6.2-RELEASE
categories	games
maintainers	eric@opendarwin.org
description	Infamous electronic fortune-cookie generator
use_bzip2	yes
master_sites	http://www.opendarwin.org/~eric/
checksums	md5 99166e1c47d4b60c865a31d59d359b16
build.type	bsd
worksrcdir	${portname}

configure	{ cd ${worksrcpath}
		  reinplace "s|/usr|${prefix}|" fortune/pathnames.h
		  reinplace "s|/usr/share|${prefix}/share|" fortune/fortune.6
		  reinplace "s|/usr/games/fortune|${prefix}/bin/fortune|" \
		    fortune/fortune.6 }

patchfiles	patch-fortune-Makefile patch-strfile-Makefile \
		patch-unstr-Makefile patch-datfiles-Makefile \
		patch-fortune.c patch-strfile.c

set datfiles	"fortunes fortunes.dat fortunes-o fortunes-o.dat fortunes2 \
		fortunes2.dat fortunes2-o fortunes2-o.dat limerick \
		limerick.dat murphy murphy.dat murphy-o murphy-o.dat \
		startrek startrek.dat zippy zippy.dat"

install		{ cd ${worksrcpath}
		  system "install -o root -m 755 -d ${prefix}/bin"
		  system "install -o root -m 755 -d ${prefix}/man/man6"
		  system "install -o root -m 755 -d ${prefix}/man/man8"
		  system "install -o root -m 755 -d \
		    ${prefix}/share/games/fortune"
		  system "install -o root -m 755 -c fortune/fortune \
		    ${prefix}/bin"
		  system "install -o root -m 755 -c strfile/strfile \
		    ${prefix}/bin"
		  system "install -o root -m 755 -c unstr/unstr \
		    ${prefix}/bin"
		  system "install -o root -m 644 -c fortune/fortune.6.gz \
		    ${prefix}/man/man6"
		  system "install -o root -m 644 -c strfile/strfile.8.gz \
		    ${prefix}/man/man8"
		  system "ln ${prefix}/man/man8/strfile.8.gz \
		    ${prefix}/man/man8/unstr.8.gz"

		  cd datfiles
		  foreach datfile $datfiles {
		    system "install -o root -m 644 -c $datfile \
		      ${prefix}/share/games/fortune" } }

contents	bin/fortune \
		bin/strfile \
		bin/unstr \
		man/man6/fortune.6.gz \
		man/man8/strfile.8.gz \
		man/man8/unstr.8.gz \
		share/games/fortune/fortunes \
		share/games/fortune/fortunes.dat \
		share/games/fortune/fortunes-o \
		share/games/fortune/fortunes-o.dat \
		share/games/fortune/fortunes2 \
		share/games/fortune/fortunes2.dat \
		share/games/fortune/fortunes2-o \
		share/games/fortune/fortunes2-o.dat \
		share/games/fortune/limerick \
		share/games/fortune/limerick.dat \
		share/games/fortune/murphy \
		share/games/fortune/murphy.dat \
		share/games/fortune/murphy-o \
		share/games/fortune/murphy-o.dat \
		share/games/fortune/startrek \
		share/games/fortune/startrek.dat \
		share/games/fortune/zippy \
		share/games/fortune/zippy.dat
