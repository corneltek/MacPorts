# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                libevt
version             20140112
categories-append   security
platforms           darwin
maintainers         nomaintainer
license             LGPL-3+

description         Library and tooling to access the Windows Event Log (EVT) format

long_description    ${description}

homepage            https://code.google.com/p/libevt/
master_sites        https://googledrive.com/host/0B3fBvzttpiiSYm01VnUtLXNUZ2M/

distname            ${name}-alpha-${version}
worksrcdir          ${name}-${version}

checksums           md5     4a0040f9b941689362b8f48e56ad48e7 \
                    rmd160  4e40a30f70a053b456619e7d9b9da8a6dddb3079 \
                    sha256  51499e3e847230333c28ae58290e1a3dbb4ec34aeba2d31a35f3aaed3d64e778

depends_lib         port:gettext



## => do the manual way, in post-destroot ...
#post-configure {
#   ## FIXME! NOK, tons of other file
#   reinplace "s|PYTHON_PACKAGE_DIR = /Library/Python/2.7/site-packages|PYTHON_PACKAGE_DIR = ${frameworks_dir}/Python.framework/Versions/2.7/lib/python2.7/site-packages|" ${worksrcpath}/Makefile
#
#}


## FIXME: a way to split in two packages: lib and python bindings?

default_variants +debug +python

variant debug description {Enable verbose and debug output} {
    configure.args-append --enable-verbose-output --enable-debug-output
}

## FIXME: howto point specific python?
variant python description {Use python 2.7} {
    depends_lib-append port:python27
    configure.args-append --enable-python \
        --with-pyprefix=`${prefix}/bin/python2.7-config --prefix`
    post-destroot {
        xinstall -d ${destroot}${frameworks_dir}/Python.framework/Versions/2.7/lib/python2.7/site-packages/
        foreach file [glob -directory ${destroot}/Library/Python/2.7/site-packages *] {
            move ${file} ${destroot}${frameworks_dir}/Python.framework/Versions/2.7/lib/python2.7/site-packages/
        }
    }
}

livecheck.type      regex
livecheck.url       [lindex ${master_sites} 0]
livecheck.regex     ${name}-alpha-(\[0-9.\]+)${extract.suffix}
