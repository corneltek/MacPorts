# $Id: Portfile,v 1.1 2003/12/09 00:53:28 fkr Exp $

PortSystem 1.0
name		slocate
version		2.7
categories	sysutils
homepage	http://www.geekreview.org/slocate/
description	Secure Locate is a replacement for locate.
long_description	Secure locate provides a secure way to index and quickly search \
			for files on your system. It uses incremental encoding just like \
			GNU locate to compress its database to make searching faster, \
			but it will also check file permissions and ownership so that \
			users will not see files they do not have access to. \
			The big advantage is that slocate will find files in your ~, even \
			if you made it unreadable by "nobody" (who traditionally performs \
			the locate database update), without letting another user find \
			files there.

platforms	darwin
maintainers	pguyot@kallisys.net
master_sites	ftp://ftp.geekreview.org/slocate/src/
checksums      	md5 4872830642ea2ed5f9aff932720583c9
patchfiles	patch-Makefile.am patch-main.c patch-doc-slocate.1.linux
configure.cmd   ./autogen.sh

pre-patch {	system "gzip -d ${worksrcpath}/doc/slocate.1.linux.gz" }

post-patch {	reinplace "s|__PREFIX__|${prefix}|g" ${worksrcpath}/main.c
	reinplace "s|__PREFIX__|${prefix}|g" ${worksrcpath}/doc/slocate.1.linux
	system "gzip ${worksrcpath}/doc/slocate.1.linux" }

pre-destroot {	addgroup slocate }
post-destroot {	system "install -d -g slocate -o root ${destroot}${prefix}/var/db/slocate"
		system "touch ${destroot}${prefix}/var/db/slocate/.turd"
		system "install ${portpath}/files/daily.slocate ${destroot}${prefix}/etc/"
		reinplace "s|__PREFIX__|${prefix}|g" ${destroot}${prefix}/etc/daily.slocate }

post-install {	ui_msg "\nslocate's database should be updated on a regular basis. In"
		ui_msg "${prefix}/etc/daily.slocate, you'll find some lines to put in"
		ui_msg "/etc/daily.local to update the database on a daily basis (for example)."
		ui_msg "If you want to disable the weekly update of the system's built-in locate,"
		ui_msg "edit the file /etc/weekly.\n" }
