--- src/lib/Makefile.orig	2010-05-24 00:40:58.000000000 -0500
+++ src/lib/Makefile	2014-01-08 13:54:41.000000000 -0600
@@ -35,13 +35,13 @@
 
 # Define new rule for libtool objects
 %.lo : %.c
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c $<
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c $<
 
 .PHONY: all clean install reconfig
 all: $(TARGET).la
 
 $(TARGET).la: $(LT_OBJS)
-	$(LIBTOOL) --mode=link $(CC) -release $(RADIUSD_VERSION) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) -release $(RADIUSD_VERSION) \
 	$(LDFLAGS) $(LINK_MODE) -o $@ -rpath $(libdir) $^
 
 $(LT_OBJS): $(INCLUDES)
--- src/main/Makefile.in.orig	2013-12-11 14:10:12.000000000 -0600
+++ src/main/Makefile.in	2014-01-08 14:03:04.000000000 -0600
@@ -68,56 +68,56 @@
 $(SERVER_OBJS): $(INCLUDES)
 
 radiusd$(EXEEXT): $(SERVER_OBJS) $(MODULE_OBJS) $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) -export-dynamic -dlopen self \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) -export-dynamic -dlopen self \
 		$(LDFLAGS) $(LINK_MODE) -o $@ $(SERVER_OBJS)      \
 		$(MODULE_LIBS) $(LIBRADIUS) $(LIBS) $(SNMP_LIBS) \
 		$(LCRYPT) $(PTHREADLIB) $(LIBLTDL)
 
 radiusd.lo: radiusd.c  ../include/modules.h ../include/modcall.h ../include/modpriv.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c radiusd.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c radiusd.c
 
 %.lo: %.c
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS)  -c $<
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS)  -c $<
 
 acct.lo: acct.c ../include/modules.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c acct.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c acct.c
 
 auth.lo: auth.c ../include/modules.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c auth.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c auth.c
 
 client.lo: client.c ../include/conffile.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c client.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c client.c
 
 conffile.lo: conffile.c ../include/conffile.h ../include/modules.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c conffile.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c conffile.c
 
 mainconfig.lo: mainconfig.c ../include/modules.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c mainconfig.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c mainconfig.c
 
 modcall.lo: modcall.c
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c modcall.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c modcall.c
 
 modules.lo: modules.c ../include/modules.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) $(VFLAGS) -c modules.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) $(VFLAGS) -c modules.c
 
 session.lo: session.c ../include/modules.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c session.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c session.c
 
 # It's #include'd for simplicity.  This should be fixed...
 listen.lo: listen.c dhcpd.c command.c
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c listen.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c listen.c
 
 #
 # Helper programs
 #
 
 radclient.lo: radclient.c $(INCLUDES)
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -I ../modules/rlm_mschap -c radclient.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -I ../modules/rlm_mschap -c radclient.c
 
 MSCHAP_OBJS := ../modules/rlm_mschap/smbdes.lo ../modules/rlm_mschap/mschap.lo 
 
 radclient$(EXEEXT): radclient.lo $(MSCHAP_OBJS) $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(LINK_MODE) -o radclient radclient.lo $(MSCHAP_OBJS) $(LIBRADIUS) $(LIBS)
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(LINK_MODE) -o radclient radclient.lo $(MSCHAP_OBJS) $(LIBRADIUS) $(LIBS)
 
 # These two rules need to be specific in order to supercede the generic
 # "compile C file" rules.
@@ -128,29 +128,29 @@
 	${MAKE} -C ../modules/rlm_mschap/
 
 radsniff.lo: radsniff.c $(INCLUDES) ../include/radsniff.h
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c radsniff.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c radsniff.c
 
 radsniff$(EXEEXT): radsniff.lo $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(LINK_MODE) -o radsniff radsniff.lo $(LIBRADIUS) $(LIBS) $(PCAP_LIBS)
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(LINK_MODE) -o radsniff radsniff.lo $(LIBRADIUS) $(LIBS) $(PCAP_LIBS)
 
 radwho.lo: radwho.c $(INCLUDES)
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c radwho.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c radwho.c
 
 radwho$(EXEEXT): radwho.lo util.lo log.lo conffile.lo $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(LINK_MODE) -o radwho radwho.lo util.lo log.lo conffile.lo $(LIBRADIUS) $(LIBS)
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(LINK_MODE) -o radwho radwho.lo util.lo log.lo conffile.lo $(LIBRADIUS) $(LIBS)
 
 radmin$(EXEEXT): radmin.lo $(LIBRADIUS) util.lo log.lo conffile.lo
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(LINK_MODE) -o $@ $^ $(LIBREADLINE) $(LIBS)
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(LINK_MODE) -o $@ $^ $(LIBREADLINE) $(LIBS)
 
 radconf2xml$(EXEEXT): radconf2xml.lo $(LIBRADIUS) util.lo log.lo conffile.lo
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(LINK_MODE) -o $@ $^ $(LIBS)
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(LINK_MODE) -o $@ $^ $(LIBS)
 
 dhcpclient.lo: dhcpclient.c $(INCLUDES)
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c dhcpclient.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c dhcpclient.c
 
 # Don't install this for now.
 dhcpclient$(EXEEXT): dhcpclient.lo $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(LINK_MODE) -o dhcpclient dhcpclient.lo $(LIBRADIUS) $(LIBS)
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(LINK_MODE) -o dhcpclient dhcpclient.lo $(LIBRADIUS) $(LIBS)
 
 clean:
 	rm -rf *.o *.so *.lo *~ $(BINARIES) .libs
--- src/modules/rlm_dbm/Makefile.in.orig	2010-05-24 00:40:58.000000000 -0500
+++ src/modules/rlm_dbm/Makefile.in	2014-01-08 13:54:41.000000000 -0600
@@ -13,11 +13,11 @@
 include ../rules.mak
 
 rlm_dbm_parser: rlm_dbm_parser.lo $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
 		-o $@ $^ $(RLM_LIBS) $(LIBS)
 
 rlm_dbm_cat: rlm_dbm_cat.lo $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
 		-o $@ $^ $(RLM_LIBS) $(LIBS)
 
 #
--- src/modules/rlm_eap/Makefile.in.orig	2013-12-11 14:10:12.000000000 -0600
+++ src/modules/rlm_eap/Makefile.in	2014-01-08 14:05:04.000000000 -0600
@@ -35,10 +35,10 @@
 include ../rules.mak
 
 radeapclient$(EXEEXT): radeapclient.lo $(CLIENTLIBS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(RLM_LDFLAGS) -o radeapclient$(EXEEXT) radeapclient.lo $(LIBRADIUS) $(CLIENTLIBS) $(LIBS)
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(RLM_LDFLAGS) -o radeapclient$(EXEEXT) radeapclient.lo $(LIBRADIUS) $(CLIENTLIBS) $(LIBS)
 
 radeapclient.lo: radeapclient.c $(HEADERS)
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) $(RLM_CFLAGS) -c radeapclient.c
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) $(RLM_CFLAGS) -c radeapclient.c
 
 install-subdirs:
 	@$(MAKE) $(MFLAGS) WHAT_TO_MAKE=install common
--- src/modules/rlm_eap/libeap/Makefile.orig	2013-12-11 14:10:12.000000000 -0600
+++ src/modules/rlm_eap/libeap/Makefile	2014-01-08 14:06:02.000000000 -0600
@@ -22,12 +22,12 @@
 
 # Define new rule for libtool objects
 %.lo: %.c
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c $<
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) -c $<
 
 all: $(TARGET).la
 
 $(TARGET).la: $(LT_OBJS)
-	$(LIBTOOL) --mode=link $(CC) -release $(RADIUSD_VERSION_STRING) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) -release $(RADIUSD_VERSION_STRING) \
 	$(LDFLAGS) $(LINK_MODE) -o $@ -rpath $(libdir) $^ \
 	$(LIBRADIUS) $(LIBS)
 	@for x in .libs/* $^; do \
--- src/modules/rlm_ippool/Makefile.in.orig	2013-12-11 14:10:12.000000000 -0600
+++ src/modules/rlm_ippool/Makefile.in	2014-01-08 14:06:41.000000000 -0600
@@ -15,7 +15,7 @@
 $(LT_OBJS): $(HEADERS)
 
 rlm_ippool_tool$(EXEEXT): rlm_ippool_tool.lo $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
 		-o $@ $^ $(RLM_LIBS) $(LIBS)
 
 # Install binary files into the bin directory
--- src/modules/rlm_mschap/Makefile.orig	2013-12-11 14:10:12.000000000 -0600
+++ src/modules/rlm_mschap/Makefile	2014-01-08 14:07:14.000000000 -0600
@@ -19,7 +19,7 @@
 $(LT_OBJS): $(HEADERS)
 
 smbencrypt$(EXEEXT): smbencrypt.lo smbdes.lo $(LIBRADIUS)
-	$(LIBTOOL) --mode=link $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) $(LDFLAGS) $(RLM_LDFLAGS) \
 		-o $@ $^ $(RLM_LIBS) $(LIBS)
 
 smbencrypt-install:
--- src/modules/rlm_sql/drivers/rules.mak.orig	2013-12-11 14:10:12.000000000 -0600
+++ src/modules/rlm_sql/drivers/rules.mak	2014-01-08 14:08:11.000000000 -0600
@@ -55,7 +55,7 @@
 #
 #######################################################################
 %.lo: %.c
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) $(RLM_SQL_CFLAGS) -c $<
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) $(RLM_SQL_CFLAGS) -c $<
 
 ifneq ($(TARGET),)
 #######################################################################
@@ -101,7 +101,7 @@
 	done
 
 $(TARGET).la: $(LT_OBJS)
-	$(LIBTOOL) --mode=link $(CC) -release $(RADIUSD_VERSION_STRING) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) -release $(RADIUSD_VERSION_STRING) \
 	-module $(LINK_MODE) $(LDFLAGS) $(RLM_SQL_LDFLAGS) -o $@ \
 	-rpath $(libdir) $^ $(RLM_SQL_LIBS)
 
--- src/modules/rules.mak.orig	2013-12-11 14:10:12.000000000 -0600
+++ src/modules/rules.mak	2014-01-08 14:08:59.000000000 -0600
@@ -63,10 +63,10 @@
 #
 #######################################################################
 %.lo: %.c
-	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) $(RLM_CFLAGS) -c $<
+	$(LIBTOOL) --mode=compile --tag=CC $(CC) $(CFLAGS) $(RLM_CFLAGS) -c $<
 
 %.lo: %.cpp
-	$(LIBTOOL) --mode=compile $(CXX) $(CFLAGS) $(RLM_CFLAGS) -c $<
+	$(LIBTOOL) --mode=compile --tag=CXX $(CXX) $(CFLAGS) $(RLM_CFLAGS) -c $<
 
 ifneq ($(TARGET),)
 #######################################################################
@@ -120,7 +120,7 @@
 	done
 
 $(TARGET).la: $(RLM_SUBDIRS) $(LT_OBJS)
-	$(LIBTOOL) --mode=link $(CC) -release $(RADIUSD_VERSION_STRING) \
+	$(LIBTOOL) --mode=link --tag=CC $(CC) -release $(RADIUSD_VERSION_STRING) \
 	-module $(LINK_MODE) $(LDFLAGS) $(RLM_LDFLAGS) -o $@     \
 	-rpath $(libdir) $^ $(LIBRADIUS) $(RLM_LIBS) $(LIBS)
 
