# $Id$

PortSystem      1.0
PortGroup       github 1.0

github.setup    peco peco 0.2.3 v
revision        0
categories      sysutils
homepage        http://peco.github.io
description     Simplistic interactive filtering tool
long_description \
        peco can be a great tool to filter stuff like logs, process stats, find \
        files, because unlike grep, you can type as you think and look through  \
        the current results.
license         MIT

maintainers     kimuraw openmaintainer
platforms       darwin

depends_build   port:go
use_configure   no
dist_subdir     go

# peco
checksums       peco-${version}.tar.gz \
                    md5 89463f226fefac197e58a1b96c814455 \
                    sha1 2252fc7a52c86779e292514cec3dfd9363de8a17 \
                    sha256 3d652eab41125fd0336c1f21c2adde3277354aedd60de62e24f56af6a9f69f6a

# dependencies to build. remember revbump when you change version of dependencies.
set go-flags.version        1
set go-runewidth.version    d70c973ddedf458fb28531e3335a972c2cc28b00
set termbox-go.version      81b415f8400796494f30d99fc9df17e03acacc71
# dependencies
master_sites-append https://github.com/jessevdk/go-flags/tarball/v${go-flags.version}:go-flags \
                    https://github.com/mattn/go-runewidth/tarball/${go-runewidth.version}:go-runewidth \
                    https://github.com/nsf/termbox-go/tarball/${termbox-go.version}:termbox-go
distfiles-append    jessevdk-go-flags-v${go-flags.version}.tar.gz:go-flags \
                    mattn-go-runewidth-${go-runewidth.version}.tar.gz:go-runewidth \
                    nsf-termbox-go-${termbox-go.version}.tar.gz:termbox-go
checksums-append    jessevdk-go-flags-v${go-flags.version}.tar.gz \
                        md5 33244c6469610036f0c38b8c772f7533 \
                        sha1 0a0878b70fa263efc3fcb330c999138772a43893 \
                        sha256 e384b7a12c91ad9202e208665cc51c5fbdf1eb21711fd9fce67426abc5adb58f \
                    mattn-go-runewidth-${go-runewidth.version}.tar.gz \
                        md5 bef4925c7f295716df921309f82b4394 \
                        sha1 b9b8b60f15f1298483b07545bc41f9b6e6d2a79f \
                        sha256 fb03cbe156fc21b974a350ca76afe667e9aa3cab08010cf36a902f32792c8723 \
                    nsf-termbox-go-${termbox-go.version}.tar.gz \
                        md5 0e7364e798fe0154eae461bf143e21e4 \
                        sha1 98c977503395d5f689c096b7ec30230a2fbbf487 \
                        sha256 5c617be6cb02f991b3a71e7ac6c5d4de50a9730a0952af6d0892fc3f02ccf8ed

# setup build sources like this:
#   workpath/
#       peco-0.1.12/
#       gopath/src/github.com/
#           peco/peco/
#           jessevdk/go-flags-v/
#             :
set gopath      ${workpath}/GOPATH
post-extract {
    move [glob ${workpath}/peco-*] ${worksrcpath}
    file mkdir ${gopath}/src/github.com/peco
    ln -s ${worksrcpath} ${gopath}/src/github.com/peco/peco
    file mkdir ${gopath}/src/github.com/jessevdk
    move [glob ${workpath}/jessevdk-go-flags-*] ${gopath}/src/github.com/jessevdk/go-flags
    file mkdir ${gopath}/src/github.com/mattn
    move [glob ${workpath}/mattn-go-runewidth-*] ${gopath}/src/github.com/mattn/go-runewidth
    file mkdir ${gopath}/src/github.com/nsf
    move [glob ${workpath}/nsf-termbox-go-*] ${gopath}/src/github.com/nsf/termbox-go
}

build.cmd       go
build.target    build
build.args      cmd/peco/peco.go
build.env       GOPATH="${gopath}"

destroot {
    xinstall ${worksrcpath}/peco ${destroot}${prefix}/bin
}
