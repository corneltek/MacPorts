# $Id$

PortSystem      1.0
PortGroup       github 1.0

github.setup    peco peco 0.2.12 v
revision        0
categories      sysutils
homepage        http://peco.github.io
description     Simplistic interactive filtering tool
long_description \
        peco can be a great tool to filter stuff like logs, process stats, find \
        files, because unlike grep, you can type as you think and look through  \
        the current results.
license         MIT

maintainers     kimuraw openmaintainer
platforms       darwin

depends_build   port:go
use_configure   no
dist_subdir     go

# peco
checksums       peco-${version}.tar.gz \
                    md5 b55c8066e822b59b5d5ca8db11b2384d \
                    sha1 632235943af4ac85f4967a19d5328f3e1fdaad66 \
                    sha256 559479d6ab82668b2bcde74b2e56afc4db0640d8c1432854180f7e4875b56534

# dependencies to build. remember revbump when you change version of dependencies.
set go-flags.version        1
set go-runewidth.version    63c378b851290989b19ca955468386485f118c65
set termbox-go.version      bb19a81afd4bc2729799d1fedb19f7bd7ee284cf
# dependencies
master_sites-append https://github.com/jessevdk/go-flags/tarball/v${go-flags.version}:go-flags \
                    https://github.com/mattn/go-runewidth/tarball/${go-runewidth.version}:go-runewidth \
                    https://github.com/nsf/termbox-go/tarball/${termbox-go.version}:termbox-go
distfiles-append    jessevdk-go-flags-v${go-flags.version}.tar.gz:go-flags \
                    mattn-go-runewidth-${go-runewidth.version}.tar.gz:go-runewidth \
                    nsf-termbox-go-${termbox-go.version}.tar.gz:termbox-go
checksums-append    jessevdk-go-flags-v${go-flags.version}.tar.gz \
                        md5 33244c6469610036f0c38b8c772f7533 \
                        sha1 0a0878b70fa263efc3fcb330c999138772a43893 \
                        sha256 e384b7a12c91ad9202e208665cc51c5fbdf1eb21711fd9fce67426abc5adb58f \
                    mattn-go-runewidth-${go-runewidth.version}.tar.gz \
                        md5 1639fe733fe7a931838627b581858645 \
                        sha1 6894f49183aec0a04ced959ea89daf50c41272b7 \
                        sha256 8a5acff98976e66eba312351a6d7ff95c1a93081355b460fc04abca89cf24aa6 \
                    nsf-termbox-go-${termbox-go.version}.tar.gz \
                        md5 71def2ea8d475fae61fe35859a545b0c \
                        sha1 90c8c0876155882da3907190309918e184d7a8f8 \
                        sha256 638d8798ac7c07f9277298a4cacbc11c62642db73715be6f7a4085ab90efecb8

# setup build sources like this:
#   workpath/
#       peco-0.1.12/
#       gopath/src/github.com/
#           peco/peco/
#           jessevdk/go-flags-v/
#             :
set gopath      ${workpath}/GOPATH
post-extract {
    file mkdir ${gopath}/src/github.com/peco
    ln -s ${worksrcpath} ${gopath}/src/github.com/peco/peco
    file mkdir ${gopath}/src/github.com/jessevdk
    move [glob ${workpath}/jessevdk-go-flags-*] ${gopath}/src/github.com/jessevdk/go-flags
    file mkdir ${gopath}/src/github.com/mattn
    move [glob ${workpath}/mattn-go-runewidth-*] ${gopath}/src/github.com/mattn/go-runewidth
    file mkdir ${gopath}/src/github.com/nsf
    move [glob ${workpath}/nsf-termbox-go-*] ${gopath}/src/github.com/nsf/termbox-go
}

build.cmd       go
build.target    build
build.args      cmd/peco/peco.go
build.env       GOPATH="${gopath}"

destroot {
    xinstall ${worksrcpath}/peco ${destroot}${prefix}/bin
}
