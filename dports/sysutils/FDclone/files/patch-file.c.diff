--- file.c.orig	2010-09-25 00:00:00.000000000 +0900
+++ file.c	2012-03-10 02:21:02.000000000 +0900
@@ -612,7 +612,7 @@
 	lockbuf_t *lck;
 	XFILE *fp;
 
-	if (!(lck = lockopen(path, flags, 0666))) return(NULL);
+	if (!(lck = lockopen(path, flags, 0666 & ~tmpumask))) return(NULL);
 
 	if (!(lck -> flags & LCK_INVALID)) {
 		if (!(fp = Xfdopen(lck -> fd, type))) {
