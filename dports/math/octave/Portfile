# $Id: Portfile,v 1.1 2003/10/12 21:57:38 gwright Exp $

PortSystem	1.0
name		octave
version		2.1.50
categories	math science
maintainers     persquare@users.sourceforge.net
platforms	darwin
description     a Matlab-like environment for numerical analysis
long_description	\
		Octave provides a convenient command line interface	\
		for solving linear and nonlinear problems numerically,	\
		using a language that is mostly compatible with Matlab.	\
		It is easily extensible and customizable via		\
		user-defined functions or using dynamically loaded	\
		modules written in e.g. C++, C or Fortran.

homepage	http://www.octave.org
master_sites	ftp://ftp.octave.org/pub/octave/bleeding-edge/

checksums	md5 14cc00f6dc57fe1f0d1a20568bc609b7

depends_build   bin:texinfo:texinfo bin:g77:g77
depends_lib     lib:libreadline.4.3:readline

configure.env   FLIBS="-lg2c" LDFLAGS="-L${prefix}/lib" \
		CPPFLAGS="-no-cpp-precomp -I${prefix}/include"

configure.args	--without-hdf5 --without-fftw --without-mpi

post-configure {
		reinplace "s|/\\* #undef HAVE_DYLD_API \\*/|#define HAVE_DYLD_API 1|g" "${worksrcpath}/config.h"

		reinplace "s|#include <Mach-O/dyld.h>|#include <mach-o/dyld.h>|g" "${worksrcpath}/liboctave/oct-shlib.cc"
		}

destroot.destdir	prefix=${destroot}${prefix}

variant hdf5	{ depends_lib lib:libhdf5:hdf5
		  configure.args-delete  --without-hdf5
		  configure.args-append  --with-hdf5
		}

