# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem              1.0

name                    nxcomp
version                 3.5.0.17

categories              net
platforms               darwin
license                 GPL-2

maintainers             cal openmaintainer

description             nxcomp is the X compression library by NX
long_description        nxcomp is a library compressing X commands to be passed over network \
                        for use with x2go.

homepage                http://www.nomachine.com/
master_sites            http://code.x2go.org/releases/source/nx-libs/
distname                nx-libs-${version}-lite
checksums               rmd160  161a8af6ce7a8df023335bfcdcbed4e2fddc90f9 \
                        sha256  eeafed65885c72ac608b455a92cd6fcdc44209833c50bb5563a206e269dfa4d7

universal_variant       yes
supported_archs         ppc i386 x86_64

depends_lib             port:libpng \
                        port:jpeg \
                        port:zlib \
                        port:xorg-xproto

use_autoreconf          yes

configure.cxxflags-append \
                        -I${prefix}/include

subport nxcomp {
    worksrcdir          nx-libs-${version}/nxcomp

    patchfiles          patch-nxcomp__configure.in.diff \
                        patch-nxcomp__Makefile.in.diff
}

subport nxproxy {
    description         nxproxy is a compressing proxy for X
    long_description    nxproxy is a library compressing X commands to be passed over network \
                        for use with x2go.

    worksrcdir          nx-libs-${version}/nxproxy

    patchfiles          patch-nxproxy__configure.in.diff \
                        patch-nxproxy__Makefile.in.diff

    configure.ldflags-append \
                        -L${prefix}/lib/nx

    depends_lib         port:nxcomp

    livecheck.type      none
}

livecheck.url           ${master_sites}
livecheck.regex         nx-libs-(\[0-9\]+(\\.\[0-9\]+)+(-\[0-9\]+)?)-lite

#destroot {
#    # the makefile does not provide an install target
#    # install headers
#    xinstall -d ${destroot}${prefix}/include/${name}
#    eval xinstall -m 0644 [glob ${worksrcpath}/NX*.h] ${destroot}${prefix}/include/${name}
#
#    # install libraries
#    set libname libXcomp.${teeny_version}.dylib
#
#    xinstall -m 0644 -W ${worksrcpath} libXcomp.a ${destroot}${prefix}/lib/libXcomp.a
#    xinstall -m 0755 -W ${worksrcpath} ${libname} ${destroot}${prefix}/lib/${libname}
#    ln -s ${libname} ${destroot}${prefix}/lib/libXcomp.${major_version}.dylib
#    ln -s ${libname} ${destroot}${prefix}/lib/libXcomp.dylib
#}

