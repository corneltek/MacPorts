--- SConstruct.orig	2015-03-14 06:24:41.000000000 -0500
+++ SConstruct	2015-04-15 05:18:13.000000000 -0500
@@ -522,7 +522,7 @@
             # here; it's a security risk.  At install time we use
             # chrpath to edit this out of RPATH.
             env.Prepend(RPATH=[os.path.realpath(os.curdir)])
-        else:
+        elif env.subst('$PLATFORM') != 'darwin':
             print "chrpath is not available; please build with chrpath=no."
 
     confdefs = ["/* gpsd_config.h.  Generated by scons, do not hand-hack.  */\n"]
@@ -922,6 +922,7 @@
         ilib_suffix = '.' + version + shlib_suffix
         shlink_flags += [ '-current_version', '%s' % version,
                           '-compatibility_version', '%s' % version,
+                          '-install_name', '%s/%s/lib%s.%s.dylib' % (env['prefix'], env['libdir'], libname, '%s' % version),
                           '-undefined', 'dynamic_lookup' ]
 
     ilib = env.SharedLibrary(libname,lib_objs,
@@ -1397,7 +1398,7 @@
 if qt_env:
     binaryinstall.append(LibraryInstall(qt_env, installdir('libdir'), compiled_qgpsmmlib))
 
-if env["shared"] and env["chrpath"]:
+if env["shared"] and env.subst('$PLATFORM') != 'darwin':
     env.AddPostAction(binaryinstall, '$CHRPATH -r "%s" "$TARGET"' \
                       % (installdir('libdir', False), ))
 
