# $Id: Portfile,v 1.3 2003/10/22 14:25:21 mww Exp $

PortSystem 1.0
name		throttled
version		0.2.9
categories	net
maintainers	mww@opendarwin.org
description	network bandwidth throttle daemon
platforms	darwin freebsd
long_description	throttled is a bandwidth throttle daemon for Mac OS X, \
			FreeBSD, and Linux which allows you to put a cap on \
			your upstream bandwidth and keep your download speeds \
			high even when your server is sending out at full speed.

homepage	http://www.intrarts.com/throttled.html
master_sites	http://www.intrarts.com/Files/
distname        ${name}${version}
patchfiles	patch-throttledStartup.diff
checksums	${distfiles} md5 ed05b43f4a4584ca5c821ab40e07cac2

depends_run	path:/Library/StartupItems/DarwinPortsStartup:DarwinPortsStartup
depends_build	bin:gnutar:gnutar

extract.post_args	| gnutar x
pre-patch	{ system "cd ${workpath} \
			&& mv ${name}\\ ${version} ${name}${version}" }

configure	{ reinplace "s|/usr/local/sbin/|${prefix}/sbin/|g" \
			${worksrcpath}/throttledStartup/throttledStartup \
			${worksrcpath}/throttled-startup }

build.target
build.dir	${worksrcpath}/src

destroot	{ system "cd ${worksrcpath} \
		&& install -m 755 ${worksrcpath}/src/throttled \
			${destroot}${prefix}/sbin \
		&& install -m 755 -d ${destroot}${prefix}/etc/rc.d \
		&& install -m 644 \
			${worksrcpath}/throttledStartup/throttledStartup \
			${destroot}${prefix}/etc/rc.d/throttled.sh \
		&& install -m 755 ${worksrcpath}/throttled-startup \
			${destroot}${prefix}/sbin \
		&& install -m 755 -d ${destroot}${prefix}/share/doc/${name} \
		&& cp README.txt COPYING.txt \
			${destroot}${prefix}/share/doc/${name}" }
destroot.target

