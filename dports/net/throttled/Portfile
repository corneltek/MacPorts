# $Id: Portfile,v 1.5 2004/01/24 13:41:54 mww Exp $

PortSystem 1.0
name		throttled
version		0.2.9
categories	net
maintainers	mww@opendarwin.org
description	network bandwidth throttle daemon
platforms	darwin freebsd
long_description	throttled is a bandwidth throttle daemon for Mac OS X, \
			FreeBSD, and Linux which allows you to put a cap on \
			your upstream bandwidth and keep your download speeds \
			high even when your server is sending out at full speed.

homepage	http://www.intrarts.com/throttled.html
master_sites	http://www.intrarts.com/Files/
distname        ${name}${version}
patchfiles	patch-throttledStartup.diff \
		patch-throttled-startup.diff

checksums	${distfiles} md5 ed05b43f4a4584ca5c821ab40e07cac2

depends_run	path:/Library/StartupItems/DarwinPortsStartup:DarwinPortsStartup
depends_build	bin:gnutar:gnutar

extract.post_args	| gnutar x
post-extract	{
	file rename ${workpath}/${name}\ ${version} ${worksrcpath}
}

post-patch	{
	reinplace "s|__PREFIX__|${prefix}|g" \
		${worksrcpath}/throttledStartup/throttledStartup \
		${worksrcpath}/throttled-startup
}

use_configure	no

build.target
build.dir	${worksrcpath}/src

destroot	{
	xinstall -m 755 -d ${destroot}${prefix}/etc/rc.d \
		${destroot}${prefix}/share/doc/${name}
	xinstall -m 755 -s ${worksrcpath}/src/throttled \
		${worksrcpath}/throttled-startup ${destroot}${prefix}/sbin
	xinstall -m 644 ${worksrcpath}/throttledStartup/throttledStartup \
		${destroot}${prefix}/etc/rc.d/throttled.sh
	xinstall -m 644 ${worksrcpath}/README.txt ${worksrcpath}/COPYING.txt \
		${destroot}${prefix}/share/doc/${name}
}
