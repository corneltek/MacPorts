# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           github 1.0
PortGroup           qmake5 1.0

github.setup        gpsbabel gpsbabel 1_5_3 gpsbabel_
# some tricks because version at github is x_y_z
version             [join [lrange [split ${version} _] 0 2] .]

categories          textproc comms
license             GPL
maintainers         nomaintainer
description         GPSBabel converts/uploads GPS waypoints, tracks, and routes
long_description    GPSBabel converts GPS waypoints, tracks, and routes \
                    from one format to another, whether that format is a \
                    common mapping format like Delorme, Streets and \
                    Trips, or even a serial upload or download to a GPS \
                    unit such as those from Garmin and Magellan.
platforms           darwin
homepage            http://www.gpsbabel.org/

depends_lib-append  port:expat \
                    port:libusb-compat \
                    port:zlib

checksums           rmd160  b64e1bbd6906a027d232e097fb182e1ed770aff7 \
                    sha256  d8606e18a4d27a25739c443f0ced506e992fe0631c8365e3e0109f74224c6e59

patchfiles          patch-delbin.cc.diff

destroot {
    if {[variant_isset universal]} {
        system -W ${worksrcpath} "lipo -create ${worksrcpath}-x86_64/GPSbabel ${worksrcpath}-i386/GPSbabel -output ${worksrcpath}/gpsbabel"
    }
    xinstall -m 755 ${worksrcpath}/gpsbabel ${destroot}${prefix}/bin
    xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 -W ${worksrcpath} AUTHORS COPYING README.contrib README.igc \
        README.mapconverter README.xmapwpt ${destroot}${prefix}/share/doc/${name}
}
