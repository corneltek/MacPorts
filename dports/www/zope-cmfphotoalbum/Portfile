# $Id: Portfile,v 1.4 2003/11/11 22:34:32 rshaw Exp $
PortSystem 1.0

name		zope-cmfphotoalbum
version		0.4rc1
categories	www python zope
maintainers	rshaw@opendarwin.org
description	Zope CMF based Photo Album object
platforms	darwin
homepage	http://sourceforge.net/projects/collective
distname	CMFPhotoAlbum-${version}
master_sites	sourceforge:collective
checksums	md5 b16f46d6eb6e57669eba30586e4d4bb5
depends_build	bin:python2.1:python21 \
		path:${prefix}/www/Zope:zope
depends_run	path:${prefix}/www/Zope/lib/python/Products/BTreeFolder2:zope-btreefolder2 \
		path:${prefix}/www/Zope/lib/python/Products/CMFCore:zope-cmf \
		path:${prefix}/www/Zope/lib/python/Products/CMFPhoto:zope-cmfphoto
configure	{}

set python	/usr/bin/env\ python2.1
set zopehome	${prefix}/www/Zope

pre-build	{ system "cp ${zopehome}/inst/compilezpy.py ${workpath}" }

build		{ system "cd ${workpath} && \
		          ${python} ${workpath}/compilezpy.py"
		  system "cd ${workpath} && \
		          ${python} -O ${workpath}/compilezpy.py" }

destroot	{ set zopebase	${destroot}${zopehome}
		  set productsdir ${zopebase}/lib/python/Products
		  set zopeuser	zope
    
		  # Copy Plone products into the Products directory
		  system "install -d ${productsdir}"
		  system "cp -R ${workpath}/CMFPhotoAlbum ${productsdir}"
		  system "cd ${zopebase} && chown -R zope lib"
		  system "cd ${zopebase} && chgrp -R www lib" }

