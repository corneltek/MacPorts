# $Id: Portfile,v 1.3 2003/12/16 05:36:37 rshaw Exp $
PortSystem 1.0
name		zope-localfs
version		1.1.0
categories	www python zope
maintainers	rshaw@opendarwin.org
description	Zope Local File System folder
long_description	The Local File System is an add-in product for \
			the Zope web application server. It allows users \
			to access the contents of the file system on a \
			Zope server as if they were contained in the \
			Zope Object Database. It allows you to serve \
			files and browse directories from the local file \
			system (or network shares on Windows platforms). \
			It also allows you to upload files to the file \
			system.
platforms	darwin
homepage	http://sourceforge.net/projects/localfs
extract.suffix	.tgz
distname	LocalFS-1-1-0
master_sites	sourceforge:localfs
checksums	md5 738c05ad9e4cb59518269bc21fa79a1d

set python	${prefix}/bin/python2.1
set pythonlib	${prefix}/lib/python2.1
set zopehome	${prefix}/www/Zope
set zopeprod	${zopehome}/lib/python/Products
set zopeuser	zope
set zopegroup	www

depends_build	bin:${python}:python21 \
		path:${zopehome}:zope

patchfiles	patch-FSObject.py
pre-patch	{ system "ln -s lib/python/Products/LocalFS ${workpath}/${distname}" }

configure	{}

pre-build	{ file copy ${zopehome}/inst/compilezpy.py ${workpath}
		  system "find ${workpath} -name '*.py\[co\]' | xargs rm" }

build		{ system "cd ${workpath} && \
			  ${python} ${workpath}/compilezpy.py" }

destroot	{ file mkdir ${destroot}${zopeprod}
		  system "cp -R ${workpath}/lib/python/Products/LocalFS ${destroot}${zopeprod}"
		  system "chown -R ${zopeuser} ${destroot}${zopeprod}"
		  system "chgrp -R ${zopegroup} ${destroot}${zopeprod}" }

