# Zope Content Management Framework Portfile ##################################
# $Id: Portfile,v 1.1 2003/08/15 21:43:17 wbb4 Exp $

PortSystem          1.0
name                zope-cmf
version             1.3.1
revision            1
categories          www python zope
maintainers         wbb4@opendarwin.org
description         The Zope Content Management Framework (CMF)
platforms           darwin
homepage            http://cmf.zope.org/
master_sites        http://cmf.zope.org/download/CMF-${version}/
distname            CMF-${version}
checksums           md5 9b016f92f71093bd8398c9319df0e818
depends_lib         path:${prefix}/www/Zope:zope
extract.post_args   | gnutar -xf -
configure           { }

set python          /usr/bin/env\ python2.1
set zopehome        ${prefix}/www/Zope

pre-build {
    system          "cp ${zopehome}/inst/compilezpy.py ${worksrcpath}"
}

build {
    system          "cd ${worksrcpath} && \
                    ${python} ${worksrcpath}/compilezpy.py"
    system          "cd ${worksrcpath} && \
                    ${python} -O ${worksrcpath}/compilezpy.py"
}

destroot {
    set zopebase    ${destroot}${zopehome}
    set productsdir ${zopebase}/lib/python/Products
    
    # Copy CMF* into the Products directory
    system          "install -d ${productsdir}"
    system          "cp -R ${worksrcpath}/CMFCalendar ${productsdir}"
    system          "cp -R ${worksrcpath}/CMFCore ${productsdir}"
    system          "cp -R ${worksrcpath}/CMFDefault ${productsdir}"
    system          "cp -R ${worksrcpath}/CMFTopic ${productsdir}"
    
    # Install docs
    system          "install -d ${destroot}${prefix}/share/doc/Zope-CMF"
    system          "cp -r ${worksrcpath}/docs/* \
                    ${destroot}${prefix}/share/doc/Zope-CMF"
} 
