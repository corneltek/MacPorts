From 3d24c6b683a97978482842f7c1c523a78c977061 Mon Sep 17 00:00:00 2001
From: Jeremy Huddleston Sequoia <jeremyhu@apple.com>
Date: Fri, 6 May 2016 00:09:27 -0700
Subject: [PATCH] Fix an incorrect usage of OS(DARWIN) with PLATFORM(COCOA)

https://bugs.webkit.org/show_bug.cgi?id=157167

Signed-off-by: Jeremy Huddleston Sequoia <jeremyhu@apple.com>
---
 Source/WebCore/ChangeLog                            | 10 ++++++++++
 Source/WebCore/platform/graphics/FontPlatformData.h | 10 ++++++----
 2 files changed, 16 insertions(+), 4 deletions(-)

--- Source/WebCore/platform/graphics/FontPlatformData.h
+++ Source/WebCore/platform/graphics/FontPlatformData.h
@@ -167,9 +167,11 @@ public:
 
     unsigned hash() const
     {
-#if PLATFORM(WIN) && !USE(CAIRO)
+#if USE(CAIRO)
+        return PtrHash<cairo_scaled_font_t*>::hash(m_scaledFont.get());
+#elif PLATFORM(WIN)
         return m_font ? m_font->hash() : 0;
-#elif OS(DARWIN)
+#elif PLATFORM(COCOA)
         uintptr_t flags = static_cast<uintptr_t>(m_isHashTableDeletedValue << 5 | m_textRenderingMode << 3 | m_orientation << 2 | m_syntheticBold << 1 | m_syntheticOblique);
 #if USE(APPKIT)
         uintptr_t fontHash = (uintptr_t)m_font.get();
@@ -178,8 +180,8 @@ public:
 #endif
         uintptr_t hashCodes[3] = { fontHash, m_widthVariant, flags };
         return StringHasher::hashMemory<sizeof(hashCodes)>(hashCodes);
-#elif USE(CAIRO)
-        return PtrHash<cairo_scaled_font_t*>::hash(m_scaledFont.get());
+#else
+#error "Unsupported configuration"
 #endif
     }
 
-- 
2.8.1

