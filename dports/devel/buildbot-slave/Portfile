# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem              1.0
PortGroup               python 1.0

name                    buildbot-slave
version                 0.8.12
categories              devel python
platforms               darwin
supported_archs         noarch
license                 GPL-2
maintainers             nomaintainer

description             buildslave for buildbot continuous integration system

long_description        Buildbot is a system to automate the compile/test \
                        cycle required by most software projects to validate \
                        code changes. This port provides the slave side of \
                        the system.

homepage                http://buildbot.net/
master_sites            https://pypi.python.org/packages/source/b/buildbot-slave/
dist_subdir             ${name}

checksums               md5     a5bdda0174e0428b14580323d35b221f \
                        rmd160  42c30f14bace0871f16f4094e72caf440e843643 \
                        sha256  905eab122dcfc9425d51f0ed0c7682e7f933e140a7203637aa12a84498bd7461

python.default_version  27

depends_lib-append      port:py${python.version}-twisted

build.env               NO_INSTALL_REQS=1

set docdir              ${prefix}/share/doc/${subport}

post-destroot {
    xinstall -d ${destroot}${docdir}
    xinstall -m 644 -W ${worksrcpath} COPYING NEWS README UPGRADING \
        ${destroot}${docdir}
    xinstall -m 644 ${worksrcpath}/docs/buildslave.1 \
        ${destroot}${prefix}/share/man/man1
}

# note some tests need py-mock
#depends_test            port:py${python.version}-mock
test.run                yes
test.env                PYTHONPATH=.
test.cmd                ${prefix}/bin/trial-${python.branch}
test.target             buildslave.test
