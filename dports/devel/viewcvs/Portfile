PortSystem 1.0
name		viewcvs
version		0.9.2
revision	0
categories	devel www
maintainers	jpm@opendarwin.org
description	Viewing the content of CVS repositories with a Webbrowser
long_description	ViewCVS was inspired by cvsweb (Zeller's version).  ViewCVS can browse directories, change logs, and specific revisions of files. It can display diffs between versions and show selections of files based on tags or branches. In addition, ViewCVS has "annotation" or "blame" support, and the beginnings of Bonsai-like query facilities. 
platforms	darwin
master_sites	http://unc.dl.sourceforge.net/sourceforge/viewcvs/ \
		http://telia.dl.sourceforge.net/sourceforge/viewcvs/ \
		http://easynews.dl.sourceforge.net/sourceforge/viewcvs/ \
		http://umn.dl.sourceforge.net/sourceforge/viewcvs/ \
		http://twtelecom.dl.sourceforge.net/sourceforge/viewcvs/ \
		http://belnet.dl.sourceforge.net/sourceforge/viewcvs/ \
		http://switch.dl.sourceforge.net/sourceforge/viewcvs/ \
		http://cesnet.dl.sourceforge.net/sourceforge/viewcvs/
checksums	md5 c7857b1ed05240ad1f691ea40044daf2
patch {
	reinplace "s|\"/usr/local/viewcvs-\" + version|\"${prefix}/viewcvs\"|g" "${worksrcpath}/viewcvs-install"
	reinplace "s|temp = raw_input(\"Installation|temp = \"\"##raw_input|g" "${worksrcpath}/viewcvs-install"
	reinplace "s|temp = raw_input(|temp = \"o\"##|g" "${worksrcpath}/viewcvs-install"
}
configure	{}
build		{}
build.cmd	./viewcvs-install
post-install {
	
	switch ${os.platform} {
		darwin {
			set cgi_path "/Library/WebServer/CGI-Executables/"
		} freebsd {
			set cgi_path "/usr/local/www/cgi-bin/"
		} default {
			puts stdout "and it was like, beep beep beep beep beep..."
		}
	}
	
	# apache port interop
	if {[ file exists ${prefix}/sbin/httpd]} {
		set cgi_path "${prefix}/www/cgi-bin/"
   	}

	system "install -o root -m 755 ${prefix}/viewcvs/cgi/query.cgi ${cgi_path}"
	system "install -o root -m 755 ${prefix}/viewcvs/cgi/viewcvs.cgi ${cgi_path}"
	
	#contents-append	\
	#	${cgi_path}query.cgi \
	#	${cgi_path}viewcvs.cgi
}
include		contents
