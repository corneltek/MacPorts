# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                gtk-mac-bundler
version             0.7.3
set branch          0.7
categories          devel
license             GPL-2
platforms           darwin
maintainers         gmail.com:gellule.xg
supported_archs     noarch

description         Mac OS X application bundle utility

long_description    A utility that aids in the creation of Mac OS X \
                    application bundles

homepage            http://sourceforge.net/projects/gtk-osx

#---------
# FETCHING
#---------
master_sites        ftp://ftp.gnome.org/pub/GNOME/sources/${name}/${branch}

distfiles           ${name}-${version}.tar.xz

#----------------------------
# EXTRACTION AND CHECKSUMMING
#----------------------------
use_xz yes

checksums           rmd160  05837f17ce94fe6822c0896007419b9b5ae4bc2c \
                    sha256  799d8d2bbd747ddddba55d32b7c9f08116e5f2b349358175b05544a4baa91365

#---------
# PATCHING
#---------
patchfiles          patch-bundler_py.diff \
                    patch-launcher_sh.diff

#---------------------------
# CONFIGURATION AND BUILDING
#---------------------------
use_configure       no

build {}

#-----------
# DEPLOYMENT
#-----------
pre-destroot {
    reinplace "s|/usr/bin/env python|${prefix}/bin/python2.7|g" ${worksrcpath}/gtk-mac-bundler.in
    reinplace "s|@PATH@|${prefix}/Library/Framework/Python.framework/Version/2.7/lib/site-packages|g" ${worksrcpath}/gtk-mac-bundler.in
    xinstall -m 755 -d ${destroot}${prefix}/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7
    copy ${worksrcpath}/bundler ${destroot}${prefix}/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/
}
destroot.args       bindir=${destroot}${prefix}/bin

#-----------
# LIVECHECK
#-----------
livecheck.type      gnome-with-unstable
