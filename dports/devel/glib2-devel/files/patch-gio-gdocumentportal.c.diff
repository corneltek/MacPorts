https://bugzilla.gnome.org/show_bug.cgi?id=769042
https://git.gnome.org/browse/glib/commit/?id=d5efa64539f71dc705826e2c0dc4ecb8354b9a77
--- gio/gdocumentportal.c.orig
+++ gio/gdocumentportal.c
@@ -33,6 +33,11 @@
 #ifndef O_PATH
 #define O_PATH 0
 #endif
+#ifndef O_CLOEXEC
+#define O_CLOEXEC 0
+#else
+#define HAVE_O_CLOEXEC 1
+#endif
 
 static GXdpDocuments *documents;
 static char *documents_mountpoint;
@@ -115,6 +120,10 @@ g_document_portal_add_document (GFile   *file,
       goto out;
     }
 
+#ifndef HAVE_O_CLOEXEC
+  fcntl (fd, F_SETFD, FD_CLOEXEC);
+#endif
+
   fd_list = g_unix_fd_list_new ();
   fd_in = g_unix_fd_list_append (fd_list, fd, error);
   g_close (fd, NULL);
