# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           perl5 1.0

name                vcheck
version             1.2.1
revision            2
categories          devel
license             Artistic-1
maintainers         nomaintainer
description         latest program package version checker and auto-downloader
long_description    vcheck is a tool for checking for latest versions of programs at HTTP \
                    and FTP locations given a list of URLs and (Perl-style) regular \
                    expressions to match, and to optionally download them automatically.

# broken link
homepage            http://www.tu-ilmenau.de/~gomar/stuff/vcheck/
platforms           darwin
supported_archs     noarch
master_sites        ${homepage}
use_bzip2           yes

checksums           rmd160  31f98e9010462d29ccc8de7c397740977ba30f04 \
                    sha256  c0a8021f5af60daf54d724772c7f21dab990e89a9283eb7dfce0cc1a565d25ea

# TODO: when using 5.22 there are some encoding-related build errors
perl5.branches      5.16

depends_lib         port:perl${perl5.major}
depends_run         port:p${perl5.major}-libwww-perl

post-extract {
    # the folder has permissions 700
    system "chmod 755 ${worksrcpath}"
}

patch {
    reinplace -locale C "s|/usr/bin/perl|${perl5.bin}|" ${worksrcpath}/vcheck
}

use_configure       no

build {
    system "${prefix}/bin/pod2man-${perl5.major} ${worksrcpath}/vcheck >${worksrcpath}/vcheck.1"
}

post-destroot {
    xinstall -c -m 755 ${worksrcpath}/vcheck ${destpath}${prefix}/bin/
    xinstall -c -m 644 ${worksrcpath}/vcheck.1 ${destpath}${prefix}/share/man/man1/
}
