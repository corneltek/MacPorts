--- wscript.orig	2012-04-11 23:27:52.000000000 +0900
+++ wscript	2012-04-11 23:27:52.000000000 +0900
@@ -49,7 +49,7 @@
 
 [Modules]
 FCGI module:             %s
-Database module:         %s
+Database module:
   have MySQL lib:          %s
   have PostgreSQL lib:     %s
 MessagePack RPC module:  %s
@@ -65,7 +65,7 @@
 Compiler version:        %s
 CXXFLAGS:                %s
 """ % (conf.env.BUILD_FCGI and 'yes' or 'no',
-       (not Options.options.disable_database) and 'yes' or 'no',
+#       (not Options.options.disable_database) and 'yes' or 'no',
        conf.env.BUILD_MYSQL and 'yes' or 'no',
        conf.env.BUILD_PGSQL and 'yes' or 'no',
        conf.env.BUILD_MPRPC and 'yes' or 'no',
--- src/database/wscript.orig	2012-04-11 23:27:52.000000000 +0900
+++ src/database/wscript	2012-04-11 23:27:52.000000000 +0900
@@ -2,15 +2,19 @@
 import Options
 
 def options(opt):
-  opt.add_option('--disable-database',
+  opt.add_option('--disable-mysql',
                  action = 'store_true',
                  default = False,
-                 help = 'disable database')
+                 help = 'disable mysql')
+  opt.add_option('--disable-postgresql',
+                 action = 'store_true',
+                 default = False,
+                 help = 'disable postgresql')
 
 def configure(conf):
   conf.env.BUILD_MYSQL = False
-  if not Options.options.disable_database:
-    if conf.check_cfg(path = 'mysql_config',
+  if not Options.options.disable_mysql:
+    if conf.check_cfg(path = '@prefix@/bin/mysql_config@my_version@',
                       args = '--cflags --libs_r',
                       package = '',
                       uselib_store = 'MYSQL',
@@ -21,10 +25,10 @@
         conf.env.BUILD_MYSQL = True
 
   conf.env.BUILD_PGSQL = False
-  if not Options.options.disable_database:
+  if not Options.options.disable_postgresql:
     try:
-      incdir = subprocess.check_output(['pg_config', '--includedir-server']).decode()
-      libdir = subprocess.check_output(['pg_config', '--libdir']).decode()
+      incdir = subprocess.check_output(['@prefix@/lib/postgresql@pg_version@/bin/pg_config', '--includedir-server']).rstrip()
+      libdir = subprocess.check_output(['@prefix@/lib/postgresql@pg_version@/bin/pg_config', '--libdir']).rstrip()
       if conf.check_cxx(lib = 'pq',
                         header_name = 'postgres.h',
                         cxxflags = '-I' + incdir,
--- src/database/postgresql/wscript.orig	2012-04-11 23:27:52.000000000 +0900
+++ src/database/postgresql/wscript	2012-04-13 01:42:46.000000000 +0900
@@ -8,4 +8,4 @@
     target = 'pficommon_database_postgresql',
     includes = '. ..',
     vnum = bld.env['VERSION'],
-    use = 'PGSQL')
+    use = ['pficommon_system', 'PGSQL'])
