# $Id$

PortSystem          1.0

name                bmake
version             20111111
set mkversion       20120112
revision            1
categories          devel
platforms           darwin
license             BSD
maintainers         mfeiri openmaintainer
homepage            http://www.crufty.net/help/sjg/bmake.html
master_sites        http://www.crufty.net/ftp/pub/sjg/

description         Portable NetBSD make
long_description    bmake is the portable version of NetBSD make.

distfiles           ${distname}${extract.suffix} \
                    mk-${mkversion}${extract.suffix}
checksums           ${distname}${extract.suffix} \
                    rmd160  becae76453f1452713057c53c6abfa76c33be47a \
                    sha256  fab45768144f36f8610609ec9eb715b2ed8af3614a07de298e8ed6ac4872bc2d \
                    mk-${mkversion}${extract.suffix} \
                    rmd160  405581838df0c511a1776d6632bae7b227538b85 \
                    sha256  79fb3155a9a505920361a8b599f0056d29f56a4e5b1ba3fb7dadb2e11718aa8f

patchfiles          patch-mk-man.diff
patch.dir           ${workpath}

use_configure       no
worksrcdir          ${name}
build.cmd           ./boot-strap
build.args          --with-default-sys-path="${prefix}/share/mk" CC=${configure.cc}
build.target        

destroot {
    file copy ${worksrcpath}/Darwin/bmake ${destroot}${prefix}/bin
    file copy ${worksrcpath}/bmake.cat1 ${destroot}${prefix}/share/man/cat1/bmake.1
    file mkdir ${destroot}${prefix}/share/mk
    system "${workpath}/mk/install-mk ${destroot}${prefix}/share/mk"
}

livecheck.type      regex
livecheck.url       ${master_sites}
livecheck.regex     "${name}-(\[\\d\]+)${extract.suffix}"
