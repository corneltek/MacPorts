# $Id: Portfile,v 1.14 2004/01/06 02:22:15 mww Exp $

PortSystem 1.0
name		apache-ant
version		1.6.0
categories	devel	
maintainers	sean@fuzzymagic.com
description	Java opensource build system
long_description	Ant is a Java based build tool. In theory it is kind of like \
			make without make's wrinkles. Ant uses XML build files that defines \
			a set of targets. Each target has dependencies (other targets) and \
			contains a set of tasks to perform.
homepage        http://ant.apache.org/

platforms	darwin freebsd
master_sites    http://apache.ttlhost.com/ant/source/ \
                http://apache.mirrors.pair.com/ant/source/ \
                http://www.apache.org/dist/ant/source/
checksums	md5 18aed5aa33951aa85c237fc4139bad6e
distname 	${name}-${version}-src
use_bzip2	yes
worksrcdir 	${name}-${version}
set antdir	java/${name}
set instdir	${prefix}/${antdir}
set chmodarg	-Dchmod.fail=false
build.cmd 	./build.sh
build.args 	${chmodarg} -Ddist.name=${name}
build.target	dist
configure { }

destroot {
	set path	${destroot}${prefix}/java/

	file mkdir ${path}
	file mkdir ${destroot}${prefix}/bin
	system "cd ${worksrcpath}; cp -R ${name} ${path}"
	system "rm ${path}${name}/bin/*.bat"
    	system "chmod -R ugo+r ${path}${name}" 
	system "ln -fs ${prefix}/java/${name}/bin/ant ${destroot}${prefix}/bin/ant"
}

variant darwin {
    build.env		JAVA_HOME=/Library/Java/Home
    extract.post_args	| gnutar -x 
}
