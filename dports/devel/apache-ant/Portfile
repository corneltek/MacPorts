# $Id: Portfile,v 1.11 2003/08/05 09:29:00 jkh Exp $

PortSystem 		1.0
name			apache-ant
version			1.5.3-1
categories		devel	
maintainers		sean@fuzzymagic.com
description		Java opensource build system
long_description	Ant is a Java based build tool. In theory it is kind of like \
			make without make's wrinkles. Ant uses XML build files that defines \
			a set of targets. Each target has dependencies (other targets) and \
			contains a set of tasks to perform.
homepage                http://ant.apache.org/

platforms		darwin freebsd
master_sites           http://apache.ttlhost.com/ant/source/ \
                    http://apache.mirrors.pair.com/ant/source/ \
                    http://www.apache.org/dist/ant/source/
distname 		${name}-${version}-src
worksrcdir 		${name}-${version}
checksums		md5 dc29c2aa1a5a24b7ede0198bde5f9da7
set antdir              java/${name}
set instdir		${prefix}/${antdir}
set chmodarg		-Dchmod.fail=false
build.cmd 		./build.sh
build.args 		${chmodarg} -Ddist.name=${name}
build.target		dist
configure { }

destroot {
	set path	${destroot}${prefix}/java/

	file mkdir ${path}
	file mkdir ${destroot}${prefix}/bin
	system "cd ${worksrcpath}; cp -R ${name} ${path}"
	system "rm ${path}${name}/bin/*.bat"
    system "chmod -R ugo+r ${path}${name}" 
	system "cd ${destroot} &&
	ln -fs ${prefix}/java/${name}/bin/ant ${prefix}/bin/ant"
}

variant darwin {
    build.env				JAVA_HOME=/Library/Java/Home		
    extract.post_args		| gnutar -x 
}
