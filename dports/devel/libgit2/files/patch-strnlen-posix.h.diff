--- src/posix.h.orig	2014-02-22 12:30:23.000000000 +0100
+++ src/posix.h	2014-02-22 12:35:02.000000000 +0100
@@ -93,6 +93,19 @@
 # define p_strnlen strnlen
 #endif
 
+#ifdef __APPLE__
+#include <Availability.h>
+#if __MAC_OS_X_VERSION_MIN_REQUIRED <= 1060
+static size_t
+strnlen (const char *string, size_t maxlen)
+{
+    const char *end = memchr (string, '\0', maxlen);
+    return end ? (size_t) (end - string) : maxlen;
+}
+# define p_strnlen strnlen
+#endif
+#endif
+
 #ifdef NO_READDIR_R
 #	include <dirent.h>
 GIT_INLINE(int) p_readdir_r(DIR *dirp, struct dirent *entry, struct dirent **result)
