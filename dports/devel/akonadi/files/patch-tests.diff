--- server/CMakeLists.txt.orig	2014-08-10 19:38:58.000000000 +0900
+++ server/CMakeLists.txt	2014-10-10 10:24:15.000000000 +0900
@@ -27,7 +27,9 @@
 include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src)
 include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/handler)
 include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/nepomuk)
-include_directories(${CMAKE_CURRENT_SOURCE_DIR}/tests)
+if(AKONADI_BUILD_TESTS AND BUILD_TESTING) 
+  include_directories(${CMAKE_CURRENT_SOURCE_DIR}/tests) 
+endif(AKONADI_BUILD_TESTS AND BUILD_TESTING)
 include_directories(${Akonadi_SOURCE_DIR}/shared)
 if(Soprano_FOUND)
   include_directories(${SOPRANO_INCLUDE_DIR})
@@ -64,7 +66,9 @@
 add_subdirectory(akonadictl)
 add_subdirectory(control)
 add_subdirectory(src)
-add_subdirectory(tests)
+if(AKONADI_BUILD_TESTS AND BUILD_TESTING) 
+  add_subdirectory(tests) 
+endif(AKONADI_BUILD_TESTS AND BUILD_TESTING) 
 
 set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${_ENABLE_EXCEPTIONS}")
 if(MYSQLD_EXECUTABLE)
