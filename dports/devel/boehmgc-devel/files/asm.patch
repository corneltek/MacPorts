--- libatomic_ops/src/atomic_ops/sysdeps/gcc/x86.h.orig	2011-06-03 02:17:00.000000000 -0700
+++ libatomic_ops/src/atomic_ops/sysdeps/gcc/x86.h	2012-05-06 20:24:11.000000000 -0700
@@ -113,7 +113,7 @@ AO_test_and_set_full(volatile AO_TS_t *a
   /* Note: the "xchg" instruction does not need a "lock" prefix */
   __asm__ __volatile__("xchgb %0, %1"
                 : "=q"(oldval), "=m"(*addr)
-                : "0"(0xff), "m"(*addr) : "memory");
+                : "0"((unsigned char)0xff), "m"(*addr) : "memory");
   return (AO_TS_VAL_t)oldval;
 }
 #define AO_HAVE_test_and_set_full
--- libatomic_ops/src/atomic_ops/sysdeps/gcc/x86_64.h.orig	2011-06-03 02:17:00.000000000 -0700
+++ libatomic_ops/src/atomic_ops/sysdeps/gcc/x86_64.h	2012-05-06 20:24:00.000000000 -0700
@@ -110,7 +110,7 @@ AO_test_and_set_full(volatile AO_TS_t *a
   /* Note: the "xchg" instruction does not need a "lock" prefix */
   __asm__ __volatile__("xchgb %0, %1"
                 : "=q"(oldval), "=m"(*addr)
-                : "0"(0xff), "m"(*addr) : "memory");
+                : "0"((unsigned char)0xff), "m"(*addr) : "memory");
   return (AO_TS_VAL_t)oldval;
 }
 #define AO_HAVE_test_and_set_full
