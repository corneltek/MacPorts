--- Makefile	2014-02-17 08:50:37.000000000 -0600
+++ /Users/harciga/dev/girara/Makefile	2014-05-03 20:40:22.000000000 -0500
@@ -67,14 +67,14 @@
 
 lib${PROJECT}.so.${SOVERSION}: ${OBJECTS}
 	$(ECHO) LD $@
-	$(QUIET)${CC} -Wl,-soname,lib${PROJECT}.so.${SOMAJOR} -shared ${LDFLAGS} -o $@ ${OBJECTS} ${LIBS}
+	$(QUIET)${CC} -Wl,-dylib_install_name,${LIBDIR}/lib${PROJECT}.${SOMAJOR}.dylib -dynamiclib -current_version ${SOVERSION} -compatibility_version ${SOMAJOR} ${LDFLAGS} -o lib${PROJECT}.${SOVERSION}.dylib ${OBJECTS} ${LIBS}
 
 clean:
 	$(QUIET)rm -rf ${OBJECTS} ${PROJECT}-${VERSION}.tar.gz \
 		${DOBJECTS} lib${PROJECT}.a lib${PROJECT}-debug.a ${PROJECT}.pc doc \
 		lib$(PROJECT).so.${SOVERSION} lib${PROJECT}-debug.so.${SOVERSION} .depend \
 		${PROJECTNV}-${VERSION}.tar.gz version.h *gcda *gcno $(PROJECT).info gcov \
-		.version-checks
+		lib${PROJECT}.${SOVERSION}.dylib .version-checks
 	$(QUIET)${MAKE} -C tests clean
 	$(QUIET)${MAKE} -C po clean
 
@@ -86,7 +86,7 @@
 
 lib${PROJECT}-debug.so.${SOVERSION}: ${DOBJECTS}
 	$(ECHO) LD $@
-	$(QUIET)${CC} -Wl,-soname,lib${PROJECT}.so.${SOMAJOR} -shared ${LDFLAGS} -o $@ ${DOBJECTS} ${LIBS}
+	$(QUIET)${CC} -Wl,-dylib_install_name,${LIBDIR}/lib${PROJECT}.${SOMAJOR}.dylib -dynamiclib -current_version ${SOVERSION} -compatibility_version ${SOMAJOR} ${LDFLAGS} -o lib${PROJECT}.${SOVERSION}.dylib ${DOBJECTS} ${LIBS}
 
 debug: options ${PROJECT}-debug
 
@@ -139,10 +139,10 @@
 install-shared: shared
 	$(ECHO) installing shared library
 	$(QUIET)mkdir -m 755 -p ${DESTDIR}${LIBDIR}
-	$(QUIET)install -m 644 lib${PROJECT}.so.${SOVERSION} ${DESTDIR}${LIBDIR}
-	$(QUIET)ln -sf lib${PROJECT}.so.${SOVERSION} ${DESTDIR}${LIBDIR}/lib${PROJECT}.so.${SOMAJOR} || \
+	$(QUIET)install -m 644 lib${PROJECT}.${SOVERSION}.dylib ${DESTDIR}${LIBDIR}
+	$(QUIET)ln -sf lib${PROJECT}.${SOVERSION}.dylib ${DESTDIR}${LIBDIR}/lib${PROJECT}.${SOMAJOR}.dylib || \
 		echo "Failed to create lib${PROJECT}.so.${SOMAJOR}. Please check if it exists and points to the correct version of lib${PROJECT}.so."
-	$(QUIET)ln -sf lib${PROJECT}.so.${SOVERSION} ${DESTDIR}${LIBDIR}/lib${PROJECT}.so || \
+	$(QUIET)ln -sf lib${PROJECT}.${SOVERSION}.dylib ${DESTDIR}${LIBDIR}/lib${PROJECT}.dylib || \
 		echo "Failed to create lib${PROJECT}.so. Please check if it exists and points to the correct version of lib${PROJECT}.so."
 
 install: options po install-static install-shared install-headers
@@ -159,7 +159,9 @@
 uninstall: uninstall-headers
 	$(ECHO) removing library file
 	$(QUIET)rm -f ${LIBDIR}/lib${PROJECT}.a ${LIBDIR}/lib${PROJECT}.so.${SOVERSION} \
-		${LIBDIR}/lib${PROJECT}.so.${SOMAJOR} ${LIBDIR}/lib${PROJECT}.so
+		${LIBDIR}/lib${PROJECT}.so.${SOMAJOR} ${LIBDIR}/lib${PROJECT}.so \
+		${LIBDIR}/lib${PROJECT}.${SOVERSION}.dylib \
+		${LIBDIR}/lib${PROJECT}.${SOMAJOR}.dylib ${LIBDIR}/lib${PROJECT}.dylib
 	$(QUIET)${MAKE} -C po uninstall
 
 uninstall-headers:
