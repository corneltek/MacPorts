# $Id: Portfile,v 1.1 2003/07/03 22:26:11 waqar Exp $
PortSystem          1.0
name                jam
version             2.5
categories          devel
maintainers         pguyot@kallisys.net
description         a software build tool like make
long_description    Jam is a software build tool (like make) from Perforce. \
                    It is very powerful tool and it is used for various \
		    projects. It is particularly adapted for C/C++ \
		    development, multiplatform projects or builds spread on \
		    several processors. MacOS X developer tools actually \
		    include a customized version of it.
homepage            http://www.perforce.com/jam/jam.html
distfiles           ${name}-${version}.tar
master_sites        ftp://ftp.perforce.com/pub/jam/ \
                    "http://public.perforce.com:8080/@md=d&cd=//public/jam/&ra=s&c=lAF@//public/jam/"
checksums           md5 d340f3c73d16a1206d0e8c88a66428e7

# This is a .tar file.
extract.cmd         tar -xf 
extract.pre_args    
extract.post_args   

# Enables optimization & Matt Armstrong memory leak patch.
patchfiles          patch-Makefile.diff \
                    patch-variable.c.diff

# Jam doesn't have a configure script
use_configure		no

# Installation.
install             {
        system "install -d ${destroot}${prefix}/bin"
        system "install -d ${destroot}${prefix}/share/doc/${name}"
        system "install -m 755 ${worksrcpath}/bin.macosxppc/jam ${destroot}${prefix}/bin/"
        system "install -m 755 ${worksrcpath}/bin.macosxppc/mkjambase ${destroot}${prefix}/bin/"
        system "install -m 644 ${worksrcpath}/Jambase.html ${destroot}/${prefix}/share/doc/${name}/"
        system "install -m 644 ${worksrcpath}/Jamfile.html ${destroot}/${prefix}/share/doc/${name}/"
}

# Metrowerks compiler.
variant mw {
        patchfiles          patch-Makefile-mw.diff \
                            patch-variable.c.diff
}

# Debug (no optimization + debug)
variant debug {
        patchfiles          patch-Makefile-debug.diff \
                            patch-variable.c.diff

            install {
	      system "install -d ${destroot}${prefix}/bin"
    	      system "install -d ${destroot}${prefix}/share/doc/${name}"
    	      system "install -m 755 ${worksrcpath}/bin.macosxppc/g/jam ${destroot}${prefix}/bin/"
    	      system "install -m 755 ${worksrcpath}/bin.macosxppc/g/mkjambase ${destroot}${prefix}/bin/"
    	      system "install -m 644 ${worksrcpath}/Jambase.html ${destroot}/${prefix}/share/doc/${name}/"
    	      system "install -m 644 ${worksrcpath}/Jamfile.html ${destroot}/${prefix}/share/doc/${name}/"
	   }
}
