--- configure.orig	2013-03-10 12:37:53.000000000 +0900
+++ configure	2013-03-10 13:00:01.000000000 +0900
@@ -19098,13 +19098,12 @@
 }
 
 unexpand_shvar() {
-    local var=$1 val n v expr quote
+    local var=$1 val n v expr
     shift
-    test "$#" == 0 && return
-    quote='s/${[^${}"]*}/"&"/g'
+    test "$#" -eq 0 && return
     for n do
         eval v='"$'$n'"'
-	v="`echo \"$v\" | sed -e \"$quote\" -e 's/[][$|.\\?*]/\\\\&/g'`"
+	v="`echo \"$v\" | sed -e 's/${[^${}\"]*}/\"&\"/g' -e 's/[][$|.\\?*]/\\\\&/g'`"
 	if test -n "$v"; then
 	    expr="${expr};s|"'\("[^$"]*\)'"$v|\\1\${$n}\"|g"
 	    case "$v" in #(
@@ -19115,8 +19114,8 @@
 esac
 	fi
     done
-    expr="${quote}${expr};"'s/"\(\${[^${}"]*}\)"/\1/g'
-    eval $var='"`echo \"\\\"${'$var'}\\\"\" | sed \"$expr;s/\\\"\\\"//g;s/^\\\"//;s/\\\"\\\$//\"`"'
+    expr='s/${[^${}"]*}/"&"/g;'"${expr};"'s/"\(\${[^${}"]*}\)"/\1/g'
+    eval $var='"`echo \"\\\"${'$var'}\\\"\" | sed \"$expr;s/\\\"//g\"`"'
 }
 
 rubylibprefix='${libdir}/${RUBY_BASE_NAME}'
