# $Id: Portfile,v 1.12 2003/10/28 12:31:49 michaelm Exp $

PortSystem 1.0
name            g77
version         3.3.2
description     gnu fortran 77 comiler
platforms       darwin freebsd
categories      lang
maintainers     michaelm@opendarwin.org
master_sites    http://mirrors.rcn.net/pub/sourceware/gcc/releases/gcc-3.3.2/ \
                http://mirrors.rcn.net/pub/sourceware/gcc/releases/gcc-3.3.2/ \
                ftp://sunsite.doc.ic.ac.uk/Mirrors/gcc.gnu.org/pub/gcc/releases/gcc-3.3.2/ \
                ftp://ftp.mirror.ac.uk/sites/sources.redhat.com/pub/gcc/releases/gcc-3.3.2/

distname        gcc-${version}
checksums       md5 60ab4d3431786a81be6522cc04bc1827

pre-configure   { system "cd ${workpath} && mkdir -p build"}
configure.env   CC="cc -no-cpp-precomp"
configure.dir   ${workpath}/build
configure.cmd   ${worksrcpath}/configure
configure.args  --enable-languages=c,f77 --infodir='${prefix}/share/info'
build.dir       ${workpath}/build
build.target    bootstrap-lean


post-destroot   {
                        cd ${destroot}/${prefix}/bin
                        system "rm -f gcc gccbug cpp gcov"
                        system "rm -f `${worksrcpath}/config.guess`*"

                        cd ${destroot}/${prefix}
                        system "ln -s ../lib/gcc-lib/`${worksrcpath}/config.guess`/${version}/include/g2c.h include/g2c.h"
                        system "rm -rf share/locale"
                        system "rm -rf man/man7"
                        system "rm -f man/man1/gcc.1"
                        system "rm -f man/man1/cpp.1"
                        system "rm -f man/man1/gcov.1"
                        system "rm -f lib/charset.alias"
                        system "rm -f share/info/gcc*"
                        system "rm -f share/info/cpp*"
               }
