--- Makefile.orig	Mon Mar  1 23:42:50 2004
+++ Makefile	Mon Mar  1 23:46:19 2004
@@ -232,26 +232,26 @@
 
 # Installation
 install: FORCE
-	if test -d $(BINDIR); then : ; else $(MKDIR) $(BINDIR); fi
-	if test -d $(LIBDIR); then : ; else $(MKDIR) $(LIBDIR); fi
-	if test -d $(STUBLIBDIR); then : ; else $(MKDIR) $(LIBDIR)/stublibs; fi
-	if test -d $(MANDIR)/man$(MANEXT); then : ; else $(MKDIR) $(MANDIR)/man$(MANEXT); fi
-	cd $(LIBDIR); rm -f dllbigarray.so dlllabltk.so dllnums.so \
+	if test -d $(DESTROOT)$(BINDIR); then : ; else $(MKDIR) $(DESTROOT)$(BINDIR); fi
+	if test -d $(DESTROOT)$(LIBDIR); then : ; else $(MKDIR) $(DESTROOT)$(LIBDIR); fi
+	if test -d $(DESTROOT)$(STUBLIBDIR); then : ; else $(MKDIR) $(DESTROOT)$(LIBDIR)/stublibs; fi
+	if test -d $(DESTROOT)$(MANDIR)/man$(MANEXT); then : ; else $(MKDIR) $(DESTROOT)$(MANDIR)/man$(MANEXT); fi
+	cd $(DESTROOT)$(LIBDIR); rm -f dllbigarray.so dlllabltk.so dllnums.so \
           dllthreads.so dllunix.so dllgraphics.so dllmldbm.so dllstr.so \
           dlltkanim.so
 	cd byterun; $(MAKE) install
-	echo "$(STUBLIBDIR)" > $(LIBDIR)/ld.conf
-	echo "$(LIBDIR)" >> $(LIBDIR)/ld.conf
-	cp ocamlc $(BINDIR)/ocamlc$(EXE)
-	cp ocaml $(BINDIR)/ocaml$(EXE)
+	echo "$(STUBLIBDIR)" > $(DESTROOT)$(LIBDIR)/ld.conf
+	echo "$(LIBDIR)" >> $(DESTROOT)$(LIBDIR)/ld.conf
+	cp ocamlc $(DESTROOT)$(BINDIR)/ocamlc$(EXE)
+	cp ocaml $(DESTROOT)$(BINDIR)/ocaml$(EXE)
 	cd stdlib; $(MAKE) install
-	cp lex/ocamllex $(BINDIR)/ocamllex$(EXE)
-	cp yacc/ocamlyacc$(EXE) $(BINDIR)/ocamlyacc$(EXE)
-	cp toplevel/toplevellib.cma $(LIBDIR)/toplevellib.cma
-	cp expunge $(LIBDIR)/expunge$(EXE)
-	cp typing/outcometree.cmi typing/outcometree.mli $(LIBDIR)
-	cp toplevel/topstart.cmo $(LIBDIR)
-	cp toplevel/toploop.cmi toplevel/topdirs.cmi toplevel/topmain.cmi $(LIBDIR)
+	cp lex/ocamllex $(DESTROOT)$(BINDIR)/ocamllex$(EXE)
+	cp yacc/ocamlyacc$(EXE) $(DESTROOT)$(BINDIR)/ocamlyacc$(EXE)
+	cp toplevel/toplevellib.cma $(DESTROOT)$(LIBDIR)/toplevellib.cma
+	cp expunge $(DESTROOT)$(LIBDIR)/expunge$(EXE)
+	cp typing/outcometree.cmi typing/outcometree.mli $(DESTROOT)$(LIBDIR)
+	cp toplevel/topstart.cmo $(DESTROOT)$(LIBDIR)
+	cp toplevel/toploop.cmi toplevel/topdirs.cmi toplevel/topmain.cmi $(DESTROOT)$(LIBDIR)
 	cd tools; $(MAKE) install
 	-cd man; $(MAKE) install
 	for i in $(OTHERLIBRARIES); do \
@@ -259,23 +259,23 @@
         done
 	cd ocamldoc; $(MAKE) install
 	if test -f ocamlopt; then $(MAKE) installopt; else :; fi
-	cd camlp4; $(MAKE) install BINDIR=$(BINDIR) LIBDIR=$(LIBDIR) MANDIR=$(MANDIR)
+	cd camlp4; $(MAKE) install BINDIR=$(BINDIR) LIBDIR=$(LIBDIR) MANDIR=$(MANDIR) DESTROOT=$(DESTROOT)
 	if test -f debugger/ocamldebug; then (cd debugger; $(MAKE) install); \
 	   else :; fi
 
 # Installation of the native-code compiler
 installopt:
 	cd asmrun; $(MAKE) install
-	cp ocamlopt $(BINDIR)/ocamlopt$(EXE)
+	cp ocamlopt $(DESTROOT)$(BINDIR)/ocamlopt$(EXE)
 	cd stdlib; $(MAKE) installopt
 	cd ocamldoc; $(MAKE) installopt
 	for i in $(OTHERLIBRARIES); do (cd otherlibs/$$i; $(MAKE) installopt) || exit $$?; done
 	if test -f ocamlc.opt; \
-	  then cp ocamlc.opt $(BINDIR)/ocamlc.opt$(EXE); else :; fi
+	  then cp ocamlc.opt $(DESTROOT)$(BINDIR)/ocamlc.opt$(EXE); else :; fi
 	if test -f ocamlopt.opt; \
-	  then cp ocamlopt.opt $(BINDIR)/ocamlopt.opt$(EXE); else :; fi
+	  then cp ocamlopt.opt $(DESTROOT)$(BINDIR)/ocamlopt.opt$(EXE); else :; fi
 	if test -f lex/ocamllex.opt; \
-	  then cp lex/ocamllex.opt $(BINDIR)/ocamllex.opt$(EXE); else :; fi
+	  then cp lex/ocamllex.opt $(DESTROOT)$(BINDIR)/ocamllex.opt$(EXE); else :; fi
 
 clean:: partialclean
 
