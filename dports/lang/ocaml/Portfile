# $Id: Portfile,v 1.12 2004/01/08 05:42:57 pguyot Exp $

PortSystem 1.0
name		ocaml
version		3.07pl2
revision	1
categories	lang
maintainers	jpm@opendarwin.org
description	Latest implementation of the Caml dialect of ML
long_description	\
	The main novelties compared with its ancestor, Caml Light, are: \
	1) Full support for objects and classes -- here combined for the \
	first time with ML-style type reconstruction. \
	2) A powerful module calculus in the style of Standard ML (but \
	retaining separate compilation). \
	3) A high-performance native code compiler (in addition to a Caml \
	Light-style bytecode compiler).
homepage	http://caml.inria.fr/ocaml
platforms	darwin freebsd
master_sites	http://caml.inria.fr/distrib/${name}-3.07/
checksums	md5 e58057f1ecca2da3fee035c846ac7db2

set worksrcpath	${workpath}/${name}-3.07/

configure.env	CFLAGS=-no-cpp-precomp
configure.pre_args	--prefix ${prefix}
configure.args	--no-tk \
		--tk-no-x11 \
		--bindir ${prefix}/bin \
		--libdir ${prefix}/lib/ocaml \
		--mandir ${prefix}/share/man

build.type	gnu
build.dir	${worksrcpath}
build.target	world opt

destroot.args	BINDIR=${destroot}/${prefix}/bin \
		LIBDIR=${destroot}/${prefix}/lib/ocaml \
		MANDIR=${destroot}/${prefix}/share/man

# Variant with LablTk (tcl & tk bindings)
variant labltk	{
	depends_lib		lib:tcl8.4:tcl \
				lib:tk8.4:tk
	configure.args-delete	--no-tk \
				--tk-no-x11
	patchfiles		patch-configure
	post-patch {
		reinplace "s|__PREFIX|${prefix}|g" ${worksrcpath}/configure
	}
}
