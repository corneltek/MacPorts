--- perlio.c.old	Tue Mar 11 08:52:25 2003
+++ perlio.c	Tue Mar 11 08:57:44 2003
@@ -50,6 +50,15 @@
 
 #include "XSUB.h"
 
+/* Under Darwin x86, <architecture/i386/fpu.h> has a structure
+ * with a field named environ. <unistd.h>, included below, cannot
+ * coexist with the #define environ _NSGetEnviron() in perl.h
+ */
+
+#ifdef __APPLE__
+#undef environ
+#endif
+
 int
 perlsio_binmode(FILE *fp, int iotype, int mode)
 {
