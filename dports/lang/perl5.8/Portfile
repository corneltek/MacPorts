PortSystem 1.0
name				perl5.8
version				5.8.0
categories			lang
maintainers			michaelm@opendarwin.org
description			Perl 5.8.0
platforms			darwin freebsd
master_sites		http://www.cpan.org/src/
distname			stable
checksums			stable${extract.sufx} md5 d9bdb180620306023fd35901a2878b62

#depends_lib			lib:libdb:db4

worksrcdir			perl-${portversion}

configure.cmd 		sh Configure
unset 				configure.pre_args

configure.post_args	-des -Dinstallprefix=${destroot}/${prefix} -Dprefix='${prefix}' \
			  		  -Dccflags="-I'${prefix}/include' -I'${prefix}/include/db4' -Dldflags=-L'${prefix}/lib' ${prefix}/lib/libdb.dylib"


pre-install	 		{system "install -o root -m 755 -d ${destroot}/${prefix}" }
		

variant threads 	{ configure.args-append -Dusethreads }


#fix to set install* variables....

variant freebsd {
				post-install { cd ${destroot}/${prefix}/lib/perl5/${version}/freebsd
								system "cat Config.pm |sed s#${destroot}/##g  >Config.pm.new" 
								system "cat .packlist | sed s#${destroot}/##g > .packlist.new" 
								system  "mv Config.pm.new Config.pm && mv .packlist.new .packlist"}
				}
variant darwin {
				post-install { cd ${destroot}/${prefix}/lib/perl5/${version}/darwin
								system "cat Config.pm |sed s#${destroot}/##g  >Config.pm.new" 
								system "cat .packlist | sed s#${destroot}/##g > .packlist.new" 
								system  "mv Config.pm.new Config.pm && mv .packlist.new .packlist"}
				}

