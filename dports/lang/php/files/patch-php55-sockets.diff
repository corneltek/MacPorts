From 189fbfd53b087099689b9198407ee0c50b17fc61 Mon Sep 17 00:00:00 2001
From: Gustavo Lopes <glopes@nebm.ist.utl.pt>
Date: Sun, 24 Feb 2013 00:47:44 +0100
Subject: [PATCH] Fix ext/sockets build with phpize

Fixes bug #64285
---
 ext/sockets/multicast.c   | 4 ----
 ext/sockets/php_sockets.h | 4 ++++
 ext/sockets/sockets.c     | 4 ----
 3 files changed, 4 insertions(+), 8 deletions(-)

diff --git a/ext/sockets/multicast.c b/ext/sockets/multicast.c
index 94f845d..7466c62 100644
--- a/ext/sockets/multicast.c
+++ b/ext/sockets/multicast.c
@@ -24,8 +24,6 @@
 
 #include "php.h"
 
-#if HAVE_SOCKETS
-
 #include "php_network.h"
 #ifdef PHP_WIN32
 # include "windows_common.h"
@@ -836,5 +834,3 @@ err:
 	return FAILURE;
 }
 #endif
-
-#endif /* HAVE_SOCKETS */
diff --git a/ext/sockets/php_sockets.h b/ext/sockets/php_sockets.h
index dd2b993..17abf95 100644
--- a/ext/sockets/php_sockets.h
+++ b/ext/sockets/php_sockets.h
@@ -24,6 +24,10 @@
 
 /* $Id$ */
 
+#if HAVE_CONFIG_H
+# include "config.h"
+#endif
+
 #if HAVE_SOCKETS
 
 #include <php.h>
diff --git a/ext/sockets/sockets.c b/ext/sockets/sockets.c
index 7f5d49e..5ecc014 100644
--- a/ext/sockets/sockets.c
+++ b/ext/sockets/sockets.c
@@ -28,8 +28,6 @@
 
 #include "php.h"
 
-#if HAVE_SOCKETS
-
 #include "php_network.h"
 #include "ext/standard/file.h"
 #include "ext/standard/info.h"
@@ -2278,8 +2276,6 @@ PHP_FUNCTION(socket_import_stream)
 }
 /* }}} */
 
-#endif
-
 /*
  * Local variables:
  * tab-width: 4
-- 
1.7.11.5

