# $Id: Portfile,v 1.2 2003/12/29 23:39:43 jkh Exp $

PortSystem 1.0
name			itcl
version			3.2.1
categories		lang
maintainers		jkh@opendarwin.org
description		OO extensions to the Tool Command Language
platforms		darwin
master_sites		sourceforge:incrtcl/
distname		${portname}${portversion}_src
extract.suffix		.tgz
checksums		md5 44dcc2129232329cacd6c8abebf38403
depends_build           lib:libtcl8.4:tcl lib:libtk8.4:tk
configure.args		--with-tcl=${tclconfig} --with-tk=${prefix}/lib
configure.env		TCLROOT=${prefix} CFLAGS=-I${portpath}/../../lang/tcl/work/tcl8.4.1/generic
build.args		CPPFLAGS=-I${prefix}/include
build.env		_RANLIB_=${filespath}/ranlib.sh
worksrcdir              ${portname}${portversion}
pre-configure           { portexec tcl build }
patchfiles		patch-Makefile.in

# reasonable default
set tclconfig ${prefix}/lib

platform darwin 7 {
	global tclconfig

	set tclconfig /System/Library/Frameworks/Tcl.framework
}

destroot {
	set _d ${destroot}${prefix}
	set _w ${worksrcpath}
	file mkdir -p ${_d}/lib/itcl3.2
	file copy -force ${_w}/itcl/library/itcl.tcl ${_d}/lib/itcl3.2
	file copy -force ${_w}/itcl/libitcl3.2.dylib ${_d}/lib
	file copy -force ${_w}/itcl/libitclstub3.2.a ${_d}/lib
	file copy -force ${_w}/itk/libitk3.2.dylib ${_d}/lib
	file copy -force ${_w}/itk/libitkstub3.2.a ${_d}/lib
	foreach x {itcl.h itclDecls.h itclInt.h itclIntDecls.h } {
		file copy -force ${_w}/itcl/generic/$x ${_d}/include
	}
	foreach x {body.n class.n code.n configbody.n delete.n ensemble.n find.n itcl.n itcl_class.n itcl_info.n itclvars.n local.n scope.n} {
		file copy -force ${_w}/itcl/doc/$x ${_d}/share/man/mann
	}
}
