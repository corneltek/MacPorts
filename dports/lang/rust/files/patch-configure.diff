diff --git a/configure b/configure
index f2afa2d..e6c859f 100755
--- a/configure
+++ b/configure
@@ -234,17 +234,7 @@ need_cmd sed
 msg "inspecting environment"
 
 CFG_OSTYPE=$(uname -s)
-CFG_CPUTYPE=$(uname -m)
-
-if [ $CFG_OSTYPE = Darwin -a $CFG_CPUTYPE = i386 ]
-then
-    # Darwin's `uname -s` lies and always returns i386. We have to use sysctl
-    # instead.
-    if sysctl hw.optional.x86_64 | grep -q ': 1'
-    then
-        CFG_CPUTYPE=x86_64
-    fi
-fi
+CFG_CPUTYPE=__BUILD_ARCH__
 
 # The goal here is to come up with the same triple as LLVM would,
 # at least for the subset of platforms we're willing to target.
@@ -363,7 +353,7 @@ fi
 step_msg "looking for build programs"
 
 probe_need CFG_PERL        perl
-probe_need CFG_CURL        curl
+probe      CFG_CURL        curl
 probe_need CFG_PYTHON      python2.7 python2.6 python2 python
 
 python_version=$($CFG_PYTHON -V 2>&1)
@@ -382,8 +372,10 @@ else
     probe_need CFG_GIT     git
 fi
 
-probe CFG_CLANG            clang++
-probe CFG_GCC              gcc
+# CFG_CLANG and CFG_GCC will be from the same compiler suite now, but we
+# don't care because we're forcing a particular compiler anyway.
+probe CFG_CLANG            $CXX
+probe CFG_GCC              $CC
 probe CFG_LD               ld
 probe CFG_LLVM_CONFIG      llvm-config
 probe CFG_VALGRIND         valgrind
@@ -494,7 +486,7 @@ then
     LLVM_VERSION=$($LLVM_CONFIG --version)
 
     case $LLVM_VERSION in
-	(3.1svn|3.1|3.0svn|3.0)
+	(3.?svn|3.?)
 	    msg "found ok version of LLVM: $LLVM_VERSION"
 	    ;;
 	(*)
@@ -516,7 +508,7 @@ then
                       | cut -d ' ' -f 2)
 
     case $CFG_CLANG_VERSION in
-        (3.0svn | 3.0 | 3.1 | 4.0 | 4.1)
+        (3.0svn | 3.? | 4.?)
         step_msg "found ok version of CLANG: $CFG_CLANG_VERSION"
         CFG_C_COMPILER="clang"
         ;;
