# $Id: Portfile,v 1.2 2003/11/21 21:33:06 matt Exp $

PortSystem 1.0
name			leafnode
version			1.9.46.rel
revision		1
categories		news
platforms		darwin
maintainers		matt@opendarwin.org
homepage		http://www.leafnode.org/
description		A small, simple and efficient NNTP server

long_description	Leafnode is a USENET software package designed for small sites \
			running any flavour of Unix, with a few tens of readers and only \
			a slow link to the net. It was originally written by Arnt Gulbrandsen \
			and improved by Cornelius Krasel and is currently being developed by \
			Matthias Andree.

master_sites		http://heanet.dl.sourceforge.net/sourceforge/${name}/ \
			http://umn.dl.sourceforge.net/sourceforge/${name}/ \
			http://easynews.dl.sourceforge.net/sourceforge/${name}/ \
			http://cesnet.dl.sourceforge.net/sourceforge/${name}/

checksums		md5 d756a475c6be11d932ec21a8eb94f2be
use_bzip2		yes


configure.args		--mandir=${prefix}/share/man \
			--infodir=${prefix}/share/info \
			--sysconfdir=${prefix}/etc/leafnode \
			--with-spooldir=${prefix}/var/spool/news \
			--with-included-pcre


pre-configure {		adduser news password={\*} uid=[nextuid] gid=[nextgid] realname=${name} home=${prefix}/var/spool/news shell=/dev/null
			addgroup news gid=[nextgid]
			}
		
post-destroot {		system "install -d -o news -m 755 '${destroot}${prefix}/var/spool/news'"
			system "touch '${destroot}${prefix}/var/spool/news/.turd'"
			system "install -d -o root -m 755 '${destroot}${prefix}/share/doc/${name}' \
			&& install -c -m 644 '${worksrcpath}/INSTALL' '${destroot}${prefix}/share/doc/${name}' \
			&& install -c -m 644 '${worksrcpath}/README' '${destroot}${prefix}/share/doc/${name}' \
			&& install -c -m 644 '${worksrcpath}/FAQ.txt' '${destroot}${prefix}/share/doc/${name}' \
			&& install -c -m 644 '${worksrcpath}/README-FQDN' '${destroot}${prefix}/share/doc/${name}'"
			}

# Notify the user how to launch Leafnode and what has been modified in the NetInfo db
post-install {		ui_msg "\nIn order to launch Leafnode you'll have to look at"
			ui_msg "share/doc/leafnode/INSTALL, there's a xinetd sample"
			ui_msg "service file.\n"
			ui_msg "Also, a 'news' user and group has been created in your"
			ui_msg "local NetInfo database. You may want to delete them"
			ui_msg "if you uninstall Leafnode.\n"
			}

variant ipv6 {		configure.args-append --with-ipv6
			}


