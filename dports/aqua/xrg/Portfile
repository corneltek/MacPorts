# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0
PortGroup       xcode 1.0

name            xrg
version         1.7.0
categories-append   sysutils
maintainers     snc openmaintainer
license             GPL-2+
description     XRG is an open source system monitor for Mac OS X.
long_description \
    XRG allows you to monitor CPU activity, memory \
    usage, battery status, machine temperature, network \
    activity, disk I/O, current weather, and stock \
    market data. The goal of XRG is to be a functional \
    system monitor that has a clean and flexible \
    interface, so it doesn't intrude on the rest of your \
    Mac experience. XRG is designed to take as little \
    CPU time as possible while still showing detailed \
    graphs on system usage.
homepage        http://www.gauchosoft.com/Products/XRG/
master_sites    http://download.gauchosoft.com/${name}/
supported_archs     i386 x86_64

worksrcdir          [string toupper ${name}].app

pre-fetch {
    if {${os.major} < 10} {
        ui_error "${name} requires OS X 10.6 or newer."
        return -code error "incompatible OS X version"
    }
}
use_zip             yes
distname        [string toupper ${name}]-release-${version}

checksums           rmd160  e217b454cb646739be69b010c1d26c0cb5d7f2c6 \
                    sha256  2abedda2bf31443ee33e26fd16a235cbf1718cbce6d39a144c1e64809d6ed21f

use_configure       no
configure.universal_archs i386 x86_64

build {
    if {![variant_isset universal]} {
        system -W ${worksrcpath}/Contents/MacOS "lipo -extract ${configure.build_arch} ${name} -output ${name}"
    }
}

destroot {
    copy ${worksrcpath}  ${destroot}${applications_dir}
}

variant universal {}

livecheck.type      regex
livecheck.url       ${homepage}
livecheck.regex     [string toupper ${name}]-\\w+-(\\d+(\\.\\d+)+)${extract.suffix}
