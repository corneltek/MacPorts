# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0
PortGroup       qmake 1.0

name		qtpfsgui
version		1.9.3
revision        7
categories	aqua graphics
license		GPL-2+
maintainers     nomaintainer
description	GUI for HDR imaging workflow
long_description Qtpfsgui is an open source graphical user interface \
                application that aims to provide a workflow for HDR imaging.
platforms	darwin
homepage	http://qtpfsgui.sourceforge.net/oldsite/
master_sites	sourceforge

set target Qtpfsgui

depends_lib-append \
    port:exiv2 \
    port:openexr \
    port:ilmbase \
    port:fftw-3 \
    port:fftw-3-single \
    port:tiff

depends_run-append \
    port:dcraw \
    port:hugin-app

checksums \
    rmd160  5188b2f1679d6788358067fe761d0c72c475bfe9 \
    sha256  016aaa339ede405bfa55d531069bd64f45fd6139836b6ea9b4d655e2734b8fd6

patchfiles      patch-project.pro.diff

post-extract {
    # generate translation files
    system -W ${worksrcpath} "${qt_bins_dir}/lrelease project.pro"
}

configure.args-append \
    LOCALSOFT="${prefix}" \
    DOCDIR="${prefix}/share/doc/${name}" \
    APPLICATIONS_DIR="${applications_dir}" \
    TARGET=${target} \
    I18NDIR=${applications_dir}/${target}.app/Contents/Resources/i18n

post-destroot {
    # allow app to find external binaries (#16524)
    foreach bin {dcraw align_image_stack} {
        ln -s ${prefix}/bin/${bin} ${destroot}${applications_dir}/${target}.app/Contents/MacOS/
    }

    # allow help menu to find documentation
    ln -s ${prefix}/share/doc/${name}/html ${destroot}${applications_dir}/${target}.app/Contents/Resources/
}
