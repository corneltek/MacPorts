PortSystem 1.0
name		emacs
version		21.2
categories	editors
maintainers	jkh@opendarwin.org
description	The GNU Emacs text editor
long_description	GNU Emacs is a self-documenting, customizable, extensible real-time display editor. \
			Users new to Emacs will be able to use basic features fairly rapidly \
			by studying the tutorial and using the self-documentation features. \
			Emacs also has an extensive interactive manual browser.  It is easily \
			extensible since its editing commands are written in Lisp.
platforms	darwin freebsd
master_sites	ftp://ftp.gnu.org/pub/gnu/emacs/
checksums	md5 f4b58e5c2d923fc92495e0c2f167c5db
configure.args	--without-x

registry.contents_recurse	yes
include	contents

variant darwin {
	patchfiles	apple-patches
	patch.pre_args	-p1
}

variant devel {
	version 21.3.50.1
	fetch.type	cvs
	cvs.root	:pserver:anoncvs@subversions.gnu.org:/cvsroot/emacs
	cvs.module	emacs
	worksrcdir	emacs
	build.target	bootstrap
	patchfiles-delete	apple-patches
}

variant x11 {
	configure.args --with-x
}

# Overrides darwin
variant carbon requires devel {
	prefix /Applications
	configure.args-append	--with-carbon
	configure.args-append	--prefix=${workpath}/build
	patchfiles		macosx-patch
	install.target		install-mac
	include macosx-contents
	install {
		system "cd ${workpath}/emacs && make install-mac && \
			( cd ${workpath}/build && tar cf - Emacs.app | \
				( cd ${prefix} && tar xf - ) ) "
	}
}
