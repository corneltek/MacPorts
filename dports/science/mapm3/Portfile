# $Id: Portfile,v 1.9 2003/08/05 09:29:29 jkh Exp $

PortSystem 1.0

name                mapm
version             3
revision			1
platforms           darwin
maintainers         michaelm@opendarwin.org
categories          science
description         cli tool for calculating Quantitative Trait Loci
master_sites        http://www-genome.wi.mit.edu/ftp/distribution/software/mapmaker3/

distname            ${name}${version}-source
extract.sufx        .tar.Z
checksums           md5 8aa7a061d32a49c8704c1a5c4b31aa2d

pre-extract         {system "mkdir -p ${worksrcpath}" }
extract.cmd         uncompress 
extract.pre_args    -c 
extract.post_args   | tar -C ${worksrcpath} -xf -

patchfiles          patch-iolib.h patch-xmapmaker patch-Makefile patch-system.h patch-xqtl



configure           { reinplace "s|^DIR= /usr/local/bin|DIR= ${prefix}/bin|g" \
                        "${worksrcpath}/Makefile" }

pre-destroot         { reinplace "s|^DIR= ${prefix}/bin|DIR= ${destroot}${prefix}/bin|g" \
                        "${worksrcpath}/Makefile" 
                       system "mkdir -p ${destroot}${prefix}/bin "
                    }



variant   large_datasets  { 
					post-patch { reinplace \
                                   "s|^SYS= -D_SYS_DARWIN -DUSE_RAND48|SYS= -D_SYS_DARWIN -DUSE_RAND48 -D_BIG_DATASETS|g" \
                                   "${worksrcpath}/Makefile" }
                                }
