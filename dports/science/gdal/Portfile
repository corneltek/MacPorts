# $Id: Portfile,v 1.2 2004/02/09 17:09:36 ssen Exp $

PortSystem 1.0
name		gdal
version		1.1.9
revision	1
maintainers	fulton@cmu.edu
platforms	darwin
description	GDAL - Geospatial Data Abstraction Library
long_description	GDAL is a translator library for raster geospatial \
			data formats that is released under an X/MIT style \
			Open Source license. As a library, it presents a \
			single abstract data model to the calling application \
			for all supported formats. The related OGR library \
			(which lives within the GDAL source tree) provides a \
			similar capability for simple features vector data. 
homepage	http://www.remotesensing.org/gdal/
master_sites	ftp://ftp.remotesensing.org/pub/gdal/
categories	science
checksums	md5 2183e206affc7bf25e0d33459ccb8572

patchfiles	patch-GDALmake.opt.in.diff

depends_lib	lib:libz.1:zlib lib:libpng:libpng lib:libtiff:tiff \
		lib:libgeotiff:libgeotiff lib:libjpeg:jpeg lib:libproj.0:proj

configure.args	--without-python   --with-libz=${prefix} --with-png=${prefix} \
	--with-libtiff=${prefix} --with-geotiff=${prefix} --with-jpeg=${prefix}
configure.env	LIBS="-L/opt/local/lib"


build.cmd	make
build.args	LD_SHARED="g++ -dynamiclib -install_name ${prefix}/lib/libgdal.1.1.dylib" \
			 SO_EXT="dylib"
build.target	""

destroot.args	LD_SHARED="g++ -dynamiclib -install_name ${prefix}/lib/libgdal.1.1.dylib" \
			 SO_EXT="dylib" prefix="${destroot}${prefix}" 


post-destroot {
	file mkdir ${destroot}${prefix}/share/doc/${name}
	file copy ${worksrcpath}/HOWTO-RELEASE ${worksrcpath}/NEWS \
		${worksrcpath}/Changelog ${worksrcpath}/VERSION \
		${destroot}${prefix}/share/doc/${name}
	system "ln -sf libgdal.1.1.dylib \
                    ${destroot}/${prefix}/lib/libgdal.1.dylib"
	system "ln -sf libgdal.1.1.dylib \
                    ${destroot}/${prefix}/lib/libgdal.dylib"
}

variant devel {
	fetch.type       cvs
	cvs.root         :pserver:anonymous@cvs.remotesensing.org:/cvsroot
	cvs.module       gdal
	cvs.password	 anonymous
	cvs.tag          HEAD
	version		 HEAD
	worksrcdir         ${cvs.module}
}

