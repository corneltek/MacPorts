--- src/wbc-gtk-orig.c	2013-08-22 14:25:13.000000000 -0700
+++ src/wbc-gtk.c	2013-09-08 23:39:38.000000000 -0700
@@ -69,6 +69,7 @@
 #include "gnm-i18n.h"
 #include <errno.h>
 #include <string.h>
+#include <gtkmacintegration/gtkosxapplication.h>
 
 #define GET_GUI_ITEM(i_) (gpointer)(gtk_builder_get_object(wbcg->gui, (i_)))
 
@@ -5738,6 +5739,37 @@
 		list_actions (wbcg->windows.actions);
 		list_actions (wbcg->templates.actions);
 	}
+    
+        // GTK-OSX-APPLICATION
+    GtkosxApplication *theApp = g_object_new (GTKOSX_TYPE_APPLICATION, NULL);
+    GtkWidget *osx_menubar, *osx_help, *osx_about, *osx_preferences, *osx_quit;
+    
+        // Define objects from gnumeric
+    osx_menubar = gtk_ui_manager_get_widget (wbcg->ui, "/ui/menubar");
+    osx_help = gtk_ui_manager_get_widget (wbcg->ui, "/menubar/Help/Help");
+    osx_about = gtk_ui_manager_get_widget (wbcg->ui, "/menubar/Help/HelpAbout");
+    osx_preferences = gtk_ui_manager_get_widget (wbcg->ui, "/menubar/Edit/EditPreferences");
+    osx_quit = gtk_ui_manager_get_widget (wbcg->ui, "/menubar/File/FileQuit");
+    
+        // Make the OS X menu bar object
+    gtkosx_application_set_menu_bar (theApp, GTK_MENU_SHELL (osx_menubar));
+    gtkosx_application_set_help_menu (theApp, GTK_MENU_ITEM (osx_help));
+    gtkosx_application_set_window_menu (theApp, NULL);
+    gtkosx_application_set_use_quartz_accelerators (theApp, TRUE);
+    
+        // Rearange certain menu items the way OS X users expect to see them
+    gtkosx_application_insert_app_menu_item (theApp, osx_about, 1);
+    gtkosx_application_insert_app_menu_item (theApp, gtk_separator_menu_item_new (), 2);
+    gtkosx_application_insert_app_menu_item (theApp, osx_preferences, 3);
+    gtkosx_application_insert_app_menu_item (theApp, gtk_separator_menu_item_new (), 4);
+    
+        // Hide the original menu items, but Window menu doesn't work...
+    gtk_widget_hide (osx_menubar);
+    gtk_widget_hide (osx_quit);
+    
+        // Tell OS X to show the menu bar
+    gtkosx_application_ready (theApp);
+        //END GTK-OSX-APPLICATION
 }
 
 GSF_CLASS_FULL (WBCGtk, wbc_gtk, NULL, NULL, wbc_gtk_class_init, NULL,
