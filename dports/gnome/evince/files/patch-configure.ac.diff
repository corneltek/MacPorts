--- configure.ac.orig	2010-09-27 11:48:44.000000000 -0700
+++ configure.ac	2013-05-06 04:05:10.000000000 -0700
@@ -164,7 +164,7 @@
 # SHELL_LIBS
 
 
-PKG_CHECK_MODULES(LIBDOCUMENT, gtk+-$GTK_API_VERSION >= $GTK_REQUIRED gio-2.0 >= $GLIB_REQUIRED)
+PKG_CHECK_MODULES(LIBDOCUMENT, gtk+-$GTK_API_VERSION >= $GTK_REQUIRED gmodule-2.0 gio-2.0 >= $GLIB_REQUIRED zlib)
 PKG_CHECK_MODULES(LIBVIEW, gtk+-$GTK_API_VERSION >= $GTK_REQUIRED gail$GAIL_API_VERSION >= $GTK_REQUIRED gthread-2.0 gio-2.0 >= $GLIB_REQUIRED)
 PKG_CHECK_MODULES(BACKEND, cairo >= $CAIRO_REQUIRED gtk+-$GTK_API_VERSION >= $GTK_REQUIRED)
 PKG_CHECK_MODULES(FRONTEND_CORE, gtk+-$GTK_API_VERSION >= $GTK_REQUIRED gthread-2.0 gio-2.0 >= $GLIB_REQUIRED)
@@ -183,7 +183,7 @@
         # require the gnome icon theme instead.
         SHELL_PLATFORM_PKGS="gnome-icon-theme >= $GNOME_ICON_THEME_REQUIRED"
         # The totem-screensaver and egg_smclient code use x11 directly.
-        SHELL_PLATFORM_PKGS="$SHELL_PLATFORM_PKGS x11"
+        SHELL_PLATFORM_PKGS="$SHELL_PLATFORM_PKGS x11 ice"
         ;;
   *)
         # On all other platforms we issue a warning about the runtime
@@ -225,7 +225,7 @@
     *) SMCLIENT_PKGS="" ;;
   esac
 
-  PKG_CHECK_MODULES([SMCLIENT],[gtk+-$GTK_API_VERSION gthread-2.0 $SMCLIENT_PKGS])
+  PKG_CHECK_MODULES([SMCLIENT],[gtk+-$GTK_API_VERSION gthread-2.0 gmodule-2.0 $SMCLIENT_PKGS])
   AC_SUBST([SMCLIENT_CFLAGS])
   AC_SUBST([SMCLIENT_LIBS])
 fi
