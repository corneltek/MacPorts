# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           python 1.0
PortGroup           github 1.0

github.setup        obspy obspy 0.10.3rc1
#version             0.9.2-2233-g${github.version}

name                py-${github.project}-devel
conflicts           py-${github.project}
categories-append   science
platforms           darwin
license             LGPL-3

maintainers         petr openmaintainer

description         Python framework for processing seismological data \
                    (development snapshot)

long_description    \
    This port provides a development snapshot of the ObsPy package, which \
    might not be always stable. \
    ObsPy is an open-source project dedicated to provide a Python framework \
    for processing seismological data. It provides support for file formats \
    and signal processing routines which allow the manipulation, analysis \
    and visualization of seismological time series. The goal of the ObsPy \
    project is to facilitate rapid application development for seismology.

homepage            http://www.obspy.org/

checksums           md5     661d640dbcdf8e61e03c9499a86739a8 \
                    rmd160  d6e98d9e9db9c11400eb2d5120d7fd7baa5d7b13 \
                    sha256  c73c8bd8b4a927a0520a514599b1a0a44e7000cf14ce0b394dad7397e2f4b283

python.versions     27 34

if {${name} ne ${subport}} {
    conflicts           py{python.version}-${github.project}

    depends_build-append    port:py${python.version}-numpy \
                            port:help2man

    depends_lib-append      port:py${python.version}-future \
                            port:py${python.version}-numpy \
                            port:py${python.version}-matplotlib \
                            port:py${python.version}-scipy \
                            port:py${python.version}-lxml \
                            port:py${python.version}-sqlalchemy


    # Note: Required for post-installation testing only 
    depends_run-append      port:py${python.version}-flake8
    # Python 3.3+: mock is available as unittest.mock
    if { ${python.version} < 33 } {
        depends_run-append  port:py${python.version}-mock
    }

    # py-scipy is not universal
    universal_variant       no

    # creates a obspy/RELEASE-VERSION file dynamically
    post-patch {
        # set release version, python version string and target file
        set ver_devel   ${version}
        set ver_fname   ${worksrcpath}/obspy/RELEASE-VERSION

        # open, write, close
        set ver_fid [open ${ver_fname} "w"]
        puts -nonewline ${ver_fid} ${ver_devel}
        close ${ver_fid}
    }

    # build man pages
    build.target-append     build_man

    post-build {

        #python ./setup.py build_man
    }

    livecheck.type  none
}
