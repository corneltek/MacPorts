# $Id: Portfile,v 1.2 2004/02/08 12:29:24 mww Exp $

PortSystem 1.0

name		py-utidylib
version		0.1
categories	python
platforms	darwin
maintainers	mww@opendarwin.org
description	Python interface to html tidy
long_description	Python interface to html tidy, the html and xml \
			cleanup tool from the w3c;

homepage	http://utidylib.sourceforge.net/
master_sites	sourceforge:utidylib
distname	uTidylib-${version}
checksums	md5 46adcf72fe9457fddc19613745073cb3
use_zip		yes
patchfiles	patch-lib.py.diff

depends_lib	bin:python:python \
		lib:libtidy:tidy \
		lib:XXX:py-ctypes \
		lib:XXX:py-epydoc

post-patch	{
	reinplace "s|LIBTIDYPATH|${prefix}/lib/libtidy.dylib|g" \
		${worksrcpath}/tidylib/lib.py
}

use_configure	no

build.cmd	python setup.py
build.target	build
post-build	{
	system "cd ${worksrcpath} && python gendoc.py"
	file rename ${worksrcpath}/apidoc ${worksrcpath}/doc
}

destroot.cmd	python setup.py
destroot.destdir	--prefix=${destroot}${prefix}

post-destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/share/doc/
	file copy ${worksrcpath}/doc ${destroot}${prefix}/share/doc/${name}
	xinstall -m 644 -W ${worksrcpath} INSTALL.txt README.path README.txt \
		${destroot}${prefix}/share/doc/${name}
}
