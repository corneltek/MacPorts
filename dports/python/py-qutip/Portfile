# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem              1.0
PortGroup               python 1.0
PortGroup               active_variants 1.1

name                    py-qutip
version                 2.2.0
categories-append       science
platforms               darwin
license                 GPL-3
maintainers             macsforever2000 openmaintainer

description             Quantum Toolbox in Python
long_description        QuTiP is open-source software for simulating the dynamics of open quantum systems.

homepage                http://code.google.com/p/qutip/
master_sites            googlecode:qutip
distname                QuTiP-${version}
worksrcdir              ${distname}

checksums               rmd160  e2e6a8c8790e8cd1444b0e4f1c52c91d42fffada \
                        sha256  a26a639d74b2754b3a1e329d91300e587e8c399d8a81d8f18a4a74c6d6f02ba3
                        
python.versions         26 27

if {$subport != $name} {
    depends_lib-append  port:py${python.version}-cython \
                        port:py${python.version}-ipython \
                        port:py${python.version}-matplotlib \
                        port:py${python.version}-mayavi \
                        port:py${python.version}-numpy \
                        port:py${python.version}-pyqt4 \
                        port:py${python.version}-scipy \
                        port:vtk5
 
    require_active_variants py${python.version}-ipython "pyqt4 notebook parallel scientific"
    require_active_variants py${python.version}-matplotlib latex
    require_active_variants vtk5 "python${python.version} qt4_mac"

    use_parallel_build  no
    python.add_archflags no

    variant gcc47 conflicts gcc48 gcc49 description "Use gfortran-mp-4.7 as fortran compiler" {
        configure.compiler  macports-gcc-4.7
        depends_lib-append  port:gcc47

        build.env-append     LDFLAGS="-undefined dynamic_lookup -bundle"

        build.args
        build.post_args-append  --with-f90mc
    }

    variant gcc48 conflicts gcc47 gcc49 description "Use gfortran-mp-4.8 as fortran compiler" {
        configure.compiler  macports-gcc-4.8
        depends_lib-append  port:gcc48

        build.env-append     LDFLAGS="-undefined dynamic_lookup -bundle"

        build.args
        build.post_args-append  --with-f90mc
    }

    variant gcc49 conflicts gcc47 gcc48 description "Use gfortran-mp-4.8 as fortran compiler" {
        configure.compiler  macports-gcc-4.9
        depends_lib-append  port:gcc49

        build.env-append     LDFLAGS="-undefined dynamic_lookup -bundle"

        build.args
        build.post_args-append  --with-f90mc
    }

    if { ![variant_isset gcc48] && ![variant_isset gcc49]} {
        default_variants    +gcc47
    }

    livecheck.type      none
} else {
    livecheck.type      regex
    livecheck.url       ${homepage}
    livecheck.regex     {QuTiP-([0-9\.]+)\.tar\.gz}
}

